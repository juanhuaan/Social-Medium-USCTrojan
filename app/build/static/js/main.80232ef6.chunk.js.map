{"version":3,"sources":["context/AuthReducer.js","context/AuthContext.js","components/topbar/Topbar.jsx","dummyData.js","components/closeFriend/CloseFriend.jsx","components/sidebar/Sidebar.jsx","components/comments/Comments.jsx","components/post/Post.jsx","components/share/Share.jsx","components/feed/Feed.jsx","components/online/Online.jsx","components/rightbar/Rightbar.jsx","pages/home/Home.jsx","apiCalls.js","pages/login/Login.jsx","pages/profile/Profile.jsx","pages/register/Register.jsx","components/conversations/Conversation.jsx","components/message/Message.jsx","components/chatOnline/ChatOnline.jsx","pages/messenger/Messenger.jsx","App.js","index.js"],"names":["AuthReducer","state","action","type","user","isFetching","error","payload","followings","filter","following","coverPicture","profilePicture","city","from","desc","relationship","password","oldPassword","INITIAL_STATE","JSON","parse","localStorage","getItem","AuthContext","createContext","AuthContextProvider","children","useReducer","dispatch","useEffect","setItem","stringify","Provider","value","Topbar","setSearchTag","setHomePage","setTimeLine","socket","useContext","PF","process","useState","postNotifications","setpostNotifications","followNotifications","setfollowNotifications","messageNotifications","setmessageNotifications","open","setOpen","logoutHandler","a","axios","get","console","log","on","data","prev","className","to","style","textDecoration","Search","placeholder","onChange","e","target","onClick","Person","length","Chat","Notifications","map","n","senderName","displayPostNotification","displayFollowNotification","displayMessageNotification","username","src","alt","Users","id","CloseFriend","Sidebar","RssFeed","PlayCircleFilledOutlined","Group","Bookmark","HelpOutline","WorkOutline","Event","School","u","Comments","postId","postUserId","setcommentNum","commentContent","useRef","comments","setComments","isFetchingComments","setIsFetchingComments","result","sort","p1","p2","Date","timestamps","fetchComments","postComment","window","alert","post","userId","_id","current","res","prevComments","prevCommentsNum","emit","receiverId","deleteHandler","commentId","delete","comment","Box","component","sx","display","flex","padding","gap","TextField","fullWidth","inputRef","multiline","variant","Button","justifyContent","CircularProgress","size","List","width","bgcolor","TransitionGroup","Divider","avatar","format","color","fontSize","content","Post","setPosts","likes","like","setLike","isLiked","setIsLiked","commentNum","setUser","currentUser","includes","isShowingComment","setIsShowingComment","fetchUser","prevPosts","prevPost","likeHandler","put","err","createdAt","img","tags","Label","htmlColor","tagStr","slice","formatting","Collapse","in","Share","file","setFile","setUserchange","submitHandler","preventDefault","tagsArr","split","newArr","val","toLowerCase","trim","newPost","FormData","fileName","now","name","append","ref","autoComplete","URL","createObjectURL","Cancel","onSubmit","htmlFor","PermMedia","accept","files","Room","EmojiEmotions","Feed","searchTag","profile","timeLine","homePage","posts","fetchPosts","allPosts","p","Online","Rightbar","friends","setFriends","followed","setFollowed","friendList","getFriends","userEdit","updatedUser","logout","handleClick","HomeRightbar","ProfileRightbar","Remove","Add","for","friend","Home","loginCall","userCredential","Login","form","email","emailConstraint","body","ifExistedEmail","ret","setCustomValidity","passwordConstraint","reportValidity","checkValidity","constraint","required","minLength","disabled","Grid","container","item","xs","Link","RouterLink","Profile","profileUser","setProfileUser","profilePicName","setProfilePicName","coverPicName","setCoverPicName","useParams","uploadFile","imgFile","imgType","updateInfo","isCurUser","Register","passwordAgain","passwordAgainConstraint","usernameConstraint","ifExistedUsername","spacing","direction","alignItems","Conversation","conversation","friendId","members","find","m","getUser","Message","message","senderId","text","ChatOnline","onlineUsers","currentId","setCurrentChat","onlineFriends","setOnlineFriends","f","o","Messenger","conversations","setConversations","currentChat","messages","setMessages","newMessage","setNewMessage","arrivalMessage","setArrivalMessage","setOnlineUsers","scrollRef","sender","users","some","getConversations","getMessages","handleSubmit","conversationId","member","scrollIntoView","behavior","c","App","setSocket","io","exact","path","defaults","baseURL","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.80232ef6.chunk.js","sourcesContent":["const AuthReducer = (state, action) => {\n  switch (action.type) {\n    case 'LOGIN_START':\n      return {\n        user: null,\n        isFetching: true,\n        error: false\n      }\n    case 'LOGIN_SUCCESS':\n      return {\n        user: action.payload,\n        isFetching: false,\n        error: false\n      }\n    case 'LOGIN_FAILURE':\n      return {\n        user: null,\n        isFetching: false,\n        error: true\n      }\n    case 'LOG_OUT':\n      return {\n        user: null,\n        isFetching: false,\n        error: false\n      }\n    case 'FOLLOW':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          followings: [...state.user.followings, action.payload]\n        }\n      }\n    case 'UNFOLLOW':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          followings: state.user.followings.filter(following => following !== action.payload)\n        }\n      }\n    case 'UPDTAECPVER':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          coverPicture: action.payload\n        }\n      }\n      case 'UPDTAEAVATAR':\n        return {\n          ...state,\n          user: {\n            ...state.user,\n            profilePicture: action.payload\n          }\n        }\n      case 'UPDATEUSER':\n        return {\n          ...state,\n          user: {\n            ...state.user,\n            //username: action.payload,\n            city: action.payload,\n            from: action.payload,\n            desc: action.payload,\n            relationship: action.payload,\n            password: action.password,\n            oldPassword: action.oldPassword\n          }\n        }\n    default:\n      return state\n  }\n}\n\nexport default AuthReducer\n","import { createContext, useEffect, useReducer } from \"react\";\nimport AuthReducer from \"./AuthReducer\";\n\nconst INITIAL_STATE = {\n  user:JSON.parse(localStorage.getItem(\"user\")) || null,\n  isFetching: false,\n  error: false,\n};\n\n\nexport const AuthContext = createContext(INITIAL_STATE);\n\nexport const AuthContextProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(AuthReducer, INITIAL_STATE);\n  \n  useEffect(()=>{\n    localStorage.setItem(\"user\", JSON.stringify(state.user))\n  },[state.user])\n  \n  return (\n    <AuthContext.Provider\n      value={{\n        user: state.user,\n        isFetching: state.isFetching,\n        error: state.error,\n        dispatch,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n","import \"./topbar.css\";\nimport { Search, Person, Chat, Notifications } from \"@material-ui/icons\";\nimport { Link } from \"react-router-dom\";\nimport { useContext, useState, useEffect } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport axios from \"axios\";\n\nexport default function Topbar({ setSearchTag, setHomePage, setTimeLine, socket }) {\n  const { user, dispatch } = useContext(AuthContext);\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const [postNotifications, setpostNotifications] = useState([]);\n  const [followNotifications, setfollowNotifications] = useState([]);\n  const [messageNotifications, setmessageNotifications] = useState([]);\n  const [open, setOpen] = useState(false);\n\n  const logoutHandler = async () => {\n    // console.log(user)\n    dispatch({ type: \"LOG_OUT\" })\n    // console.log(user)\n    try {\n      await axios.get(\"/\");\n    } catch (err) { console.log(err) }\n  };\n\n  const HomepageHandler = () => {\n    setHomePage(true);\n    setTimeLine(false);\n  }\n\n  const TimelineHandle = () => {\n    setTimeLine(true);\n    setHomePage(false);\n  }\n\n  useEffect(() => {\n    socket?.on(\"getPostNotification\", (data) => {\n      setpostNotifications((prev) => [...prev, data]);\n    });\n\n    socket?.on(\"getFollowNotification\", (data) => {\n      setfollowNotifications((prev) => [...prev, data]);\n    });\n\n    socket?.on(\"getMessageNotification\", (data) => {\n      setmessageNotifications((prev) => [...prev, data]);\n    });\n  }, [socket]);\n\n\n  console.log(postNotifications)\n\n  const displayPostNotification = ({ senderName, type }) => {\n    let action;\n\n    if (type === \"like\") {\n      action = \"liked\";\n    } else {\n      action = \"commented\";\n    }\n    return (\n      <span className=\"Notification\">{`${senderName} ${action} your post.`}</span>\n    );\n  };\n\n  const displayFollowNotification = ({ senderName }) => {\n\n    return (\n      <span className=\"Notification\">{`${senderName} followed you.`}</span>\n    );\n  };\n\n  const displayMessageNotification = ({ senderName }) => {\n  \n    return (\n      <span className=\"Notification\">{`${senderName} sent you a new message.`}</span>\n    );\n  };\n\n  const handleRead = () => {\n    setpostNotifications([]);\n    setfollowNotifications([]);\n    setmessageNotifications([]);\n    setOpen(false);\n  };\n\n  return (\n    <div className=\"topbarContainer\">\n      <div className=\"topbarLeft\">\n        <Link to=\"/\" style={{ textDecoration: \"none\" }}>\n          <span className=\"logo\">Trojan Familly</span>\n        </Link>\n      </div>\n      <div className=\"topbarCenter\">\n        <div className=\"searchbar\">\n          <Search className=\"searchIcon\" />\n          <input\n            placeholder=\"Try searching for people, topics, or keywords\"\n            className=\"searchInput\"\n            onChange={(e) => { setSearchTag(e.target.value) }}\n          />\n        </div>\n      </div>\n      <div className=\"topbarRight\">\n        <div className=\"topbarLinks\">\n          <span className=\"topbarLink\" onClick={HomepageHandler} >Homepage</span>\n          <span className=\"topbarLink\" onClick={TimelineHandle}>Timeline</span>\n          <span className=\"topbarLink\" onClick={logoutHandler}>Log Out</span>\n        </div>\n        <div className=\"topbarIcons\" onClick={() => setOpen(!open)}>\n          <div className=\"topbarIconItem\">\n            <Person />\n            {\n              followNotifications.length >0 &&\n              <span className=\"topbarIconBadge\">{followNotifications.length}</span>\n            }\n          </div>\n          <div className=\"topbarIconItem\" >\n            <Chat />\n            {\n              messageNotifications.length >0 &&\n              <Link to=\"/messenger\" style={{ textDecoration: \"none\" }}>\n                <span className=\"topbarIconBadge\">{messageNotifications.length}</span>\n              </Link>\n            }\n          </div>\n          <div className=\"topbarIconItem\" >\n            <Notifications />\n            {\n              postNotifications.length >0 &&\n              <span className=\"topbarIconBadge\">{postNotifications.length}</span>\n            }\n          </div>\n        </div>\n        {open && (\n          <div className=\"notifications\">\n            {postNotifications.map((n) => displayPostNotification(n))}\n            {followNotifications.map((n) => displayFollowNotification(n))}\n            {messageNotifications.map((n) => displayMessageNotification(n))}\n            <button className=\"nButton\" onClick={handleRead}>\n              Mark as read\n            </button>\n          </div>\n        )}\n        <Link to={`/profile/${user.username}`}>\n          <img\n            src={\n              user.profilePicture\n                ? PF + user.profilePicture\n                : PF + \"person/noAvatar.png\"\n            }\n            alt=\"\"\n            className=\"topbarImg\"\n          />\n        </Link>\n        \n      </div>\n      \n    </div>    \n    \n  );\n}\n","export const Users = [\n  {\n    id:1,\n    profilePicture: \"person/1.jpeg\",\n    username: \"Safak Kocaoglu\",\n  },\n  {\n    id:2,\n    profilePicture: \"person/2.jpeg\",\n    username: \"Janell Shrum\",\n  },\n  {\n    id:3,\n    profilePicture: \"person/3.jpeg\",\n    username: \"Alex Durden\",\n  },\n  {\n    id:4,\n    profilePicture: \"person/4.jpeg\",\n    username: \"Dora Hawks\",\n  },\n  {\n    id:5,\n    profilePicture: \"person/5.jpeg\",\n    username: \"Thomas Holden\",\n  },\n  {\n    id:6,\n    profilePicture: \"person/6.jpeg\",\n    username: \"Shirley Beauchamp\",\n  },\n  {\n    id:7,\n    profilePicture: \"person/7.jpeg\",\n    username: \"Travis Bennett\",\n  },\n  {\n    id:8,\n    profilePicture: \"person/8.jpeg\",\n    username: \"Kristen Thomas\",\n  },\n  {\n    id:9,\n    profilePicture: \"person/9.jpeg\",\n    username: \"Gary Duty\",\n  },\n  {\n    id:10,\n    profilePicture: \"person/10.jpeg\",\n    username: \"Safak Kocaoglu\",\n  },\n];\n\nexport const Posts = [\n  {\n    id: 1,\n    desc: \"Love For All, Hatred For None.\",\n    photo: \"post/1.jpeg\",\n    date: \"5 mins ago\",\n    userId: 1,\n    like: 32,\n    comment: 9,\n  },\n  {\n    id: 2,\n    photo: \"post/2.jpeg\",\n    date: \"15 mins ago\",\n    userId: 2,\n    like: 2,\n    comment: 1,\n  },\n  {\n    id: 3,\n    desc: \"Every moment is a fresh beginning.\",\n    photo: \"post/3.jpeg\",\n    date: \"1 hour ago\",\n    userId: 3,\n    like: 61,\n    comment: 2,\n  },\n  {\n    id: 4,\n    photo: \"post/4.jpeg\",\n    date: \"4 hours ago\",\n    userId: 4,\n    like: 7,\n    comment: 3,\n  },\n  {\n    id: 5,\n    photo: \"post/5.jpeg\",\n    date: \"5 hours ago\",\n    userId: 5,\n    like: 23,\n    comment: 5,\n  },\n  {\n    id: 6,\n    photo: \"post/6.jpeg\",\n    date: \"1 day ago\",\n    userId: 6,\n    like: 44,\n    comment: 6,\n  },\n  {\n    id: 7,\n    desc: \"Never regret anything that made you smile.\",\n    photo: \"post/7.jpeg\",\n    date: \"2 days ago\",\n    userId: 7,\n    like: 52,\n    comment: 3,\n  },\n  {\n    id: 8,\n    photo: \"post/8.jpeg\",\n    date: \"3 days ago\",\n    userId: 8,\n    like: 15,\n    comment: 1,\n  },\n  {\n    id: 9,\n    desc: \"Change the world by being yourself.\",\n    photo: \"post/9.jpeg\",\n    date: \"5 days ago\",\n    userId: 9,\n    like: 11,\n    comment: 2,\n  },\n  {\n    id: 10,\n    photo: \"post/10.jpeg\",\n    date: \"1 week ago\",\n    userId: 10,\n    like: 104,\n    comment: 12,\n  },\n];\n","import \"./closeFriend.css\";\n\nexport default function CloseFriend({user}) {\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  return (\n    <li className=\"sidebarFriend\">\n      <img className=\"sidebarFriendImg\" src={PF+user.profilePicture} alt=\"\" />\n      <span className=\"sidebarFriendName\">{user.username}</span>\n    </li>\n  );\n}\n","import \"./sidebar.css\";\nimport {\n  RssFeed,\n  Chat,\n  PlayCircleFilledOutlined,\n  Group,\n  Bookmark,\n  HelpOutline,\n  WorkOutline,\n  Event,\n  School,\n} from \"@material-ui/icons\";\nimport { Users } from \"../../dummyData\";\nimport CloseFriend from \"../closeFriend/CloseFriend\";\nimport { Link } from \"react-router-dom\";\n\nexport default function Sidebar() {\n  return (\n    <div className=\"sidebar\">\n      <div className=\"sidebarWrapper\">\n        <ul className=\"sidebarList\">\n          <li className=\"sidebarListItem\">\n            <RssFeed className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Feed</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Chat className=\"sidebarIcon\" />\n            <Link to={`/messenger`} style={{ textDecoration: \"none\" }}>\n              <span className=\"sidebarListItemText\">Chats</span>\n            </Link> \n          </li>\n          <li className=\"sidebarListItem\">\n            <PlayCircleFilledOutlined className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Videos</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Group className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Groups</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Bookmark className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Bookmarks</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <HelpOutline className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Questions</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <WorkOutline className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Jobs</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <Event className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Events</span>\n          </li>\n          <li className=\"sidebarListItem\">\n            <School className=\"sidebarIcon\" />\n            <span className=\"sidebarListItemText\">Courses</span>\n          </li>\n        </ul>\n        <button className=\"sidebarButton\">Show More</button>\n        <hr className=\"sidebarHr\" />\n        <ul className=\"sidebarFriendList\">\n          {Users.map((u) => (\n            <CloseFriend key={u.id} user={u} />\n          ))}\n        </ul>\n      </div>\n    </div>\n  );\n}\n","import * as React from \"react\"\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\nimport ListItemAvatar from '@mui/material/ListItemAvatar';\nimport Avatar from '@mui/material/Avatar';\nimport Divider from '@mui/material/Divider';\nimport Box from '@mui/material/Box'\nimport { TextField, Button, CircularProgress, Collapse } from \"@mui/material\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { TransitionGroup } from 'react-transition-group';\nimport { format } from \"timeago.js\";\nimport { Link } from \"react-router-dom\";\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { useContext, useEffect, useState, useRef } from \"react\";\n\nexport function Comments({ postId, postUserId, setcommentNum, socket }) {\n\n    const commentContent = useRef()\n    const [comments, setComments] = useState([])\n    //const [isPosting, setIsPosting] = useState(false)\n    const [isFetchingComments, setIsFetchingComments] = useState(true)\n\n    const { user } = useContext(AuthContext)\n\n    const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n    // fetch comments\n    useEffect(() => {\n        /**\n         * Method: GET \n         * URL: /posts/:postId/comments\n         * Desc: get all comment for given post\n         * */\n        const fetchComments = async (postId) => {\n            setIsFetchingComments(true)\n            try {\n                const result = await axios.get(`/posts/${postId}/comments`)\n                //console.log(result)\n                setComments(result.data.sort((p1, p2) => {\n                    return new Date(p2.timestamps) - new Date(p1.timestamps);\n                  }));\n                //console.log(comments)\n            } catch (err) {\n                console.log(err)\n            }\n            setIsFetchingComments(false)\n        }\n        // window.setTimeout(() => {\n        //     fetchComments(postId)\n        // }, 20)\n        fetchComments(postId)\n    }, [postId])\n\n    // push comments\n    /**\n     * Method: POST\n     * URL: /posts/:postId/comments\n     * Params: {\n     data: {\n        userId: String\n        content: String\n        timestamp: Date // might not needed\n     }}\n     * Desc: current user post a comment under the given Post\n     * */\n    const postComment = async () => {\n        //setIsPosting(true)\n        if (!user) {\n            window.alert(\"You are not login!\")\n        } else {\n            try {\n                const res = await axios.post(`/posts/${postId}/comments`, {\n                    userId: user._id ?? null,\n                    desc: commentContent.current.value\n                })\n                //console.log(res.data);\n                commentContent.current.value = null;\n\n                setComments(prevComments => {\n                    return [res.data, ...prevComments]\n                });\n                \n                setcommentNum(prevCommentsNum => prevCommentsNum + 1);\n                console.log(comments)\n\n                socket.emit(\"sendPostNotification\", {\n                    // senderId: user._id,\n                    senderName: user.username,\n                    receiverId: postUserId,\n                    type:\"comment\",\n                });\n\n            } catch (err) {\n                console.error(\"Fail to post!\")\n            }\n        }\n        //setIsPosting(false)\n    }\n\n\n    // useEffect(() => {\n    //     setIsLiked(post.likes.includes(currentUser._id));\n    // }, [comments]);\n\n\n    const deleteHandler = async (commentId, userId) => {\n        try {\n            // console.log(commentId)\n            // console.log(userId)\n            await axios.delete(\"/posts/\" + commentId, { data: { userId, postId } });\n            setComments(prevComments => {\n                return prevComments.filter(comment => comment.commentId !== commentId);\n            });\n            setcommentNum(prevCommentsNum => prevCommentsNum - 1);\n        } catch (err) { console.error(err) }\n    }\n\n    return (\n        <>\n            <Box\n                component=\"form\"\n                sx={{\n                    display: 'flex',\n                    flex: 'row nowrap',\n                    padding: '8px 16px',\n                    gap: '5px'\n                }}\n            >\n                <TextField\n                    fullWidth\n                    inputRef={commentContent}\n                    multiline\n                    variant=\"standard\"\n                ></TextField>\n                <Button onClick={postComment}>Comment</Button>\n            </Box>\n            {isFetchingComments &&\n                <Box\n                    sx={{\n                        display: 'flex',\n                        flex: 'row nowarp',\n                        justifyContent: 'center'\n                    }}\n                >\n                    <CircularProgress  size = '1rem'/>\n                </Box>\n            }\n            <List\n                sx={{\n                    width: '100%',\n                    bgcolor: 'background.paper'\n                }}\n            >\n            <TransitionGroup >\n                {comments.map((comment) => (\n                    <Collapse key={comment.commentId}>\n                        <Divider variant=\"middle\" component=\"li\" />\n                        \n                        <div className=\"commentTop\">\n                            <div className=\"commentTopLeft\">\n                                <Link to={`/profile/${comment.username}`}>\n                                    <img\n                                        className=\"commentProfileImg\"\n                                        src={\n                                            comment.avatar\n                                                ? PF + comment.avatar\n                                                : PF + \"person/noAvatar.png\"\n                                        }\n                                        alt=\"\"\n                                    />\n                                </Link>\n                                <span className=\"postUsername\">{comment.username}</span>\n                                <span className=\"postDate\">{format(comment.timestamps)}</span>\n                            </div>\n                            <div>\n                                {comment.username === user.username &&\n                                    <Button size=\"small\" color=\"primary\" onClick={(e) =>deleteHandler(comment.commentId, comment.userId)}>\n                                        <DeleteIcon fontSize=\"small\" />\n                                    </Button>}\n                            </div>\n                        </div>\n                        <div className=\"commentCenter\">\n                            <span className=\"postText\">{comment?.content}</span>\n                        </div>\n                    </Collapse>\n                ))}\n            </TransitionGroup>\n            </List>\n        </>\n    )\n}","import \"./post.css\";\nimport Button from '@mui/material/Button';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { Collapse } from \"@material-ui/core\";\nimport { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { format } from \"timeago.js\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { Comments } from \"../comments/Comments\";\nimport { Label } from \"@material-ui/icons\";\n\nexport default function Post({ post, setPosts, socket }) {\n    const [like, setLike] = useState(post.likes.length);\n    const [isLiked, setIsLiked] = useState(false);\n    const [commentNum, setcommentNum] = useState(post.comments.length);\n\n    const [user, setUser] = useState({});\n\n    const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n    const { user: currentUser } = useContext(AuthContext);\n\n    useEffect(() => {\n        setIsLiked(post.likes.includes(currentUser._id));\n    }, [currentUser._id, post.likes]);\n\n    const [isShowingComment, setIsShowingComment] = useState(false)\n\n\n    useEffect(() => {\n        const fetchUser = async () => {\n            const res = await axios.get(`/users?userId=${post.userId}`);\n            setUser(res.data);\n        };\n        fetchUser();\n    }, [post.userId]);\n\n    const deleteHandler = async () => {\n        try {\n            await axios.delete(\"/posts/\" + post._id, { data: { userId: currentUser._id } });\n            //window.location.reload();\n            setPosts(prevPosts => {\n                return prevPosts.filter(prevPost => prevPost._id !== post._id);\n            })\n        } catch (err) { console.error(err) }\n    }\n\n    const likeHandler = () => {\n        try {\n            axios.put(\"/posts/\" + post._id + \"/like\", { userId: currentUser._id });\n        } catch (err) { }\n        setLike(isLiked ? like - 1 : like + 1);\n        setIsLiked(!isLiked);\n        if(!isLiked) {\n            socket.emit(\"sendPostNotification\", {\n                // senderId: user._id,\n                senderName: currentUser.username,\n                receiverId: post.userId,\n                type:\"like\"\n            });\n        }\n    };\n\n    const formatting = (tags) => {\n        let tagStr = \"\"\n        for (let tag of tags) {\n            tagStr += tag + \", \";\n        }\n        return tagStr.slice(0, tagStr.length - 2)\n    }\n\n    return (\n        <div className=\"post\">\n            <div className=\"postWrapper\">\n                <div className=\"postTop\">\n                    <div className=\"postTopLeft\">\n                        <Link to={`/profile/${user.username}`}>\n                            <img\n                                className=\"postProfileImg\"\n                                src={\n                                    user.profilePicture\n                                        ? PF + user.profilePicture\n                                        : PF + \"person/noAvatar.png\"\n                                }\n                                alt=\"\"\n                            />\n                        </Link>\n                        <span className=\"postUsername\">{user.username}</span>\n                        <span className=\"postDate\">{format(post.createdAt)}</span>\n                    </div>\n                    <div className=\"postTopRight\">\n                        {post.userId === currentUser._id &&\n                            <Button size=\"small\" color=\"primary\" onClick={deleteHandler}>\n                                <DeleteIcon fontSize=\"small\" /> &nbsp;  Delete\n                            </Button>}\n                    </div>\n                </div>\n                <div className=\"postCenter\">\n                    <span className=\"postText\">{post?.desc}</span>\n                    <img className=\"postImg\" src={PF + post.img} alt=\"\" />\n                </div>\n\n                {(post.tags[0] !== \"\") && <div className=\"postSub\">\n                    <Label htmlColor=\"#5C94CD\" className=\"tagIcon\" />\n                    <span className=\"tagText\"> {formatting(post?.tags)}</span>\n                </div>}\n                {/* <hr className=\"shareHr\" /> */}\n                <div className=\"postBottom\">\n                    <div className=\"postBottomLeft\">\n                        <img\n                            className=\"likeIcon\"\n                            src={`${PF}like.png`}\n                            onClick={likeHandler}\n                            alt=\"\"\n                        />\n                        <img\n                            className=\"likeIcon\"\n                            src={`${PF}heart.png`}\n                            onClick={likeHandler}\n                            alt=\"\"\n                        />\n                        <span className=\"postLikeCounter\">{like} people like it</span>\n                    </div>\n                    <div className=\"postBottomRight\" onClick={() => {\n                        setIsShowingComment(!isShowingComment)\n                    }}>\n                        <span className=\"postCommentText\">\n                            {commentNum} comment(s)\n                            <img\n                                className={\n                                    \"postCommentArrow \" +\n                                    (isShowingComment ? \"downward\" : \"\")\n                                }\n                                src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAB7UlEQVRIie2QT0iTcRjHv7+971uH6lAwooIOttlqcxphFBEM3R/eFljBS4FFBBV0CYROnTrUPTxKXSI6GEFZMX21HKsRJrbed8NteuigRSGEDY3Z9nueTobUnKt53Of6fb6fLzxAgwb1opy9eCXb7Gudydqp/HqK2wPB4PbdTY8Vj9eXU1Tt4R5vy2w+baXXQ37wWDBKwAOSfEmZTFsfm1vbEqpw3Hf7/PP5tDVRj/xQZ/gkEfdBlrs+JEffKACQs1KzHv+BIQf4rsvrL05l7PH/kbcHwt1EfIdJ6qlkfAIAlOUwZ6e+un1tgw5Qn8uzX5uezCT/Sd6hX2XmW0KIyPvEy9+vVlYeTWWsuSbXvqdQ1V73Xu+W6WwmUYv8cOfxa2C6rkJ0vIubuZWZqFQ4YRi7iNWRclkOmk/6e6rL9RsMvkAKBcdNc+bPvOIAAEROn9vBKA1zmUaGBx71AOC/5KHobRCdEqyE3r56/qmSZ9UBAIgYxjb5E0OSyR4daLkM3KTl3pFQtJeJjmobEHkdi82t5qg6AAABw9js+CFfSNAXsTjf7XQ6+fP34j3ikpsKQh8bixWq9dccAIBw+PymJa3wjIm+MTNLyVsXRKnLNs3Ftbo1DQCAS9c37mStn5mgLC2cicfjxVq7DRrUxy9bgs+Fme8W0AAAAABJRU5ErkJggg==\"\n                            />\n                        </span>\n                    </div>\n                </div>\n            </div>\n\n            <Collapse\n                in={isShowingComment}\n                className=\"commentWrapper\"\n            >\n                <Comments\n                    className=\"comment\"\n                    postId={post._id}\n                    postUserId={post.userId}\n                    setcommentNum = {setcommentNum}\n                    socket = {socket}\n                >\n                </Comments>\n            </Collapse>\n        </div>\n    );\n}\n","import \"./share.css\";\nimport {\n  PermMedia,\n  Label,\n  Room,\n  EmojiEmotions,\n  Cancel,\n  SettingsInputSvideoRounded,\n} from \"@material-ui/icons\";\nimport { Link } from \"react-router-dom\";\nimport { useContext, useRef, useState, useEffect} from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport axios from \"axios\";\n\nexport default function Share({ setPosts }) {\n  const { user } = useContext(AuthContext);\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const tags = useRef();\n  const desc = useRef();\n  const [file, setFile] = useState(null);\n  const [userchange, setUserchange] = useState(false);\n\n\n  useEffect(() => {\n    \n    setUserchange(true);\n   }, [user]);\n   \n  const submitHandler = async (e) => {\n    e.preventDefault();\n    let tagsArr = [];\n    tagsArr = tags.current.value.split(\",\");\n    let newArr = tagsArr.map(val => val.toLowerCase().trim())\n    const newPost = {\n      userId: user._id,\n      desc: desc.current.value,\n      tags: newArr\n    };\n    if (file) {\n      const data = new FormData();\n      const fileName = Date.now() + file.name;\n      data.append(\"name\", fileName);\n      data.append(\"file\", file);\n      newPost.img = fileName;\n      console.log(newPost);\n      try {\n        await axios.post(\"/upload\", data);\n      } catch (err) { }\n    }\n    try {\n      const res = await axios.post(\"/posts\", newPost);\n      console.log(res);\n      setPosts(prevPosts => {\n        return [res.data, ...prevPosts]\n      });\n      desc.current.value = null;\n      tags.current.value = null;\n      setFile(null);\n      //window.location.reload();\n      // 1. Notify Feed to refresh\n      // 2. Motify User model to re-fetch data from server\n    } catch (err) { }\n  };\n\n\n\n  return (\n    <div className=\"share\">\n      <div className=\"shareWrapper\">\n        <div className=\"shareTop\">\n        <Link to={`/profile/${user.username}`}>\n          <img\n            className=\"shareProfileImg\"\n            src={\n              user.profilePicture\n                ? PF + user.profilePicture\n                : PF + \"person/noAvatar.png\"\n            }\n            alt=\"\"\n          />\n          </Link>\n          <form className=\"shareForm\">\n            <input\n              placeholder={\"Hi \" + user.username + \", what's happening?\"}\n              className=\"shareInput\"\n              ref={desc}\n            />\n            <div className=\"shareOption\">\n              <Label htmlColor=\"#5C94CD\" className=\"shareIcon\" />\n              <input\n                placeholder={\"# tags (comma is a must): weather, mood, study, travel, cat, ...\"}\n                type=\"text\"\n                className=\"tagInput\"\n                ref={tags}\n                autoComplete=\"text\"\n              />\n            </div>\n          </form>\n        </div>\n        <hr className=\"shareHr\" />\n        {file && (\n          <div className=\"shareImgContainer\">\n            <img className=\"shareImg\" src={URL.createObjectURL(file)} alt=\"\" />\n            <Cancel className=\"shareCancelImg\" onClick={() => setFile(null)} />\n          </div>\n        )}\n        <form className=\"shareBottom\" onSubmit={submitHandler}>\n          <div className=\"shareOptions\">\n            <label htmlFor=\"file\" className=\"shareOption\">\n              <PermMedia htmlColor=\"tomato\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Photo or Video</span>\n              <input\n                style={{ display: \"none\" }}\n                type=\"file\"\n                id=\"file\"\n                accept=\".png,.jpeg,.jpg\"\n                onChange={(e) => setFile(e.target.files[0])}\n              />\n            </label>\n            {/* <div className=\"shareOption\">\n              <Label htmlColor=\"blue\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Tag</span>  \n            </div> */}\n            <div className=\"shareOption\">\n              <Room htmlColor=\"green\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Location</span>\n            </div>\n            <div className=\"shareOption\">\n              <EmojiEmotions htmlColor=\"goldenrod\" className=\"shareIcon\" />\n              <span className=\"shareOptionText\">Feelings</span>\n            </div>\n          </div>\n          <button className=\"shareButton\" type=\"submit\">\n            Share\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n","import { useContext, useEffect, useState } from \"react\";\nimport Post from \"../post/Post\";\nimport Share from \"../share/Share\";\nimport \"./feed.css\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\n\nexport default function Feed({ username, searchTag, profile, timeLine, homePage, socket }) {\n  const [posts, setPosts] = useState([]);\n  const { user } = useContext(AuthContext);\n\n  // console.log('Feed username', username)\n  // console.log('Feed searchTag', searchTag)\n\n  // timeLine \n  useEffect(() => {\n    const fetchPosts = async () => {\n      const res = await axios.get(\"/posts/timeline/\" + user._id);\n      //: await axios.get(\"/posts/homepage/\" + user._id);\n\n      setPosts(\n        res.data.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt);\n        })\n      );\n    };\n    if (timeLine === true) fetchPosts();\n  }, [timeLine]);\n\n  // profile  \n  useEffect(() => {\n    const fetchPosts = async () => {\n      const res = await axios.get(\"/posts/profile/\" + username)\n      // const res = username\n      //       ? await axios.get(\"/posts/profile/\" + username)\n      //       : await axios.get(\"/posts/timeline/\" + user._id);\n      //: await axios.get(\"/posts/homepage/\" + user._id);\n\n      setPosts(\n        res.data.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt);\n        })\n      );\n    };\n    console.log(`profile name: ${username}, profile: ${profile}`,)\n    if (!!username) {\n      fetchPosts();\n    }\n\n  }, [username, profile]);\n\n\n  // homepage feed \n  useEffect(() => {\n    const fetchPosts = async () => {\n      const res = await axios.get(\"/posts/homepage/\" + user._id);\n      // const res = username\n      //   ? await axios.get(\"/posts/profile/\" + username)\n      //   // : await axios.get(\"/posts/timeline/\" + user._id);\n      //   : await axios.get(\"/posts/homepage/\" + user._id);\n\n      setPosts(\n        res.data.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt);\n        })\n      );\n    };\n    if (homePage === true) fetchPosts();\n  }, [username, user._id, homePage]);\n\n  // search function\n  useEffect(() => {\n    const fetchPosts = async () => {\n      // const res = await axios.get(\"/posts/timeline/\" + user._id);\n      const res = !!username ? await axios.get(\"/posts/profile/\" + username)\n        : await axios.get(\"/posts/homepage/\" + user._id);\n      let allPosts = res.data;\n      if (!!searchTag) {\n        allPosts = allPosts.filter(p => p.tags.includes(searchTag) || p.desc.includes(searchTag));\n      }\n      setPosts(\n        allPosts.sort((p1, p2) => {\n          return new Date(p2.createdAt) - new Date(p1.createdAt);\n        })\n      );\n    };\n    if (!!user) {\n      fetchPosts();\n    }\n    // console.log('change searchTag', searchTag)\n  }, [searchTag]);\n\n  return (\n    <div className=\"feed\">\n      <div className=\"feedWrapper\">\n        {((!username || username === user.username) && (profile !== true)) && <Share setPosts={setPosts} />}\n        {posts.map((p) => (\n          <Post key={p._id} post={p} setPosts={setPosts} socket={socket} />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import \"./online.css\";\n\nexport default function Online({user}) {\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n  return (\n    <li className=\"rightbarFriend\">\n      <div className=\"rightbarProfileImgContainer\">\n        <img className=\"rightbarProfileImg\" src={PF+user.profilePicture} alt=\"\" />\n        <span className=\"rightbarOnline\"></span>\n      </div>\n      <span className=\"rightbarUsername\">{user.username}</span>\n    </li>\n  );\n}\n","import \"./rightbar.css\";\nimport { Users } from \"../../dummyData\";\nimport Online from \"../online/Online\";\nimport EditIcon from '@mui/icons-material/Edit';\nimport { useContext, useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { Add, Remove } from \"@material-ui/icons\";\n//import { Edit } from \"client/src/components/edit/Edit.jsx\";\n\nexport default function Rightbar({ user, setUser, socket }) {\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const username = useRef();\n  const city = useRef();\n  const from = useRef();\n  const desc = useRef();\n  const relationship = useRef();\n  const oldPassword = useRef();\n  const password = useRef();\n  const [friends, setFriends] = useState([]);\n  const { user: currentUser, dispatch } = useContext(AuthContext);\n  const [followed, setFollowed] = useState(\n    currentUser.followings.includes(user?._id)\n  );\n\n\n\n  useEffect(() => {\n    const getFriends = async () => {\n      try {\n        const friendList = await axios.get(\"/users/friends/\" + user._id);\n        setFriends(friendList.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    getFriends();\n    setFollowed(currentUser.followings.includes(user?._id));\n  }, [user]);\n\n  const submitHandler = async () => {\n    const userEdit = {\n      //username: username.current.value || user.username,\n      userId: user._id,\n      desc: desc.current.value || user.desc,\n      from: from.current.value || user.from,\n      city: city.current.value || user.city,\n      relationship: relationship.current.value || user.relationship,\n    };\n    if (!!password.current.value && !!oldPassword.current.value) {\n      userEdit.password = password.current.value;\n      userEdit.oldPassword = oldPassword.current.value\n    }\n    console.log('userEdit', userEdit)\n    const updatedUser = {\n      ...user,\n      ...userEdit,\n    }\n    setUser(updatedUser)\n    console.log(updatedUser)\n    try {\n      const res = await axios.put(\"/users/\" + user._id, userEdit);\n      console.log(res);\n      dispatch({ type: 'UPDATEUSER', payload: userEdit })\n      setUser(currentUser);\n      // window.location.reload();\n      console.log(\"Upload Successfully\");\n\n      desc.current.value = null;\n      from.current.value = null;\n      city.current.value = null;\n      relationship.current.value = null;\n      if (userEdit.password) {\n        await logout();\n      }\n      password.current.value = null;\n      oldPassword.current.value = null\n\n      //await logout();\n    } catch (err) {\n      console.error(err)\n    }\n  }\n\n  const logout = async () => {\n    // console.log(user)\n    dispatch({ type: \"LOG_OUT\" })\n    // console.log(user)\n    try {\n      await axios.get(\"/\");\n    } catch (err) { console.log(err) }\n  };\n\n\n  const handleClick = async () => {\n    try {\n      if (followed) {\n        await axios.put(`/users/${user._id}/unfollow`, {\n          userId: currentUser._id,\n        });\n        dispatch({ type: \"UNFOLLOW\", payload: user._id });\n      } else {\n        await axios.put(`/users/${user._id}/follow`, {\n          userId: currentUser._id,\n        });\n        dispatch({ type: \"FOLLOW\", payload: user._id });\n      }\n      setFollowed(!followed);\n      if (!followed) {\n        socket.emit(\"sendFollowNotification\", {\n          senderName: currentUser.username,\n          receiverId: user._id\n        });\n      }\n\n    } catch (err) {\n      console.error(err)\n    }\n  };\n\n  const HomeRightbar = () => {\n    return (\n      <>\n        <div className=\"birthdayContainer\">\n          <img className=\"birthdayImg\" src=\"assets/gift.png\" alt=\"\" />\n          <span className=\"birthdayText\">\n            <b>Pola Foster</b> and <b>3 other friends</b> have a birhday today.\n          </span>\n        </div>\n        <img className=\"rightbarAd\" src=\"assets/usc.png\" alt=\"\" />\n        <h4 className=\"rightbarTitle\">Online Friends</h4>\n        <ul className=\"rightbarFriendList\">\n          {Users.map((u) => (\n            <Online key={u.id} user={u} />\n          ))}\n        </ul>\n      </>\n    );\n  };\n\n  const ProfileRightbar = () => {\n    return (\n      <>\n        {user.username !== currentUser.username && (\n          <button className=\"rightbarFollowButton\" onClick={handleClick}>\n            {followed ? \"Unfollow\" : \"Follow\"}\n            {followed ? <Remove /> : <Add />}\n          </button>\n        )}\n\n\n        {user.username === currentUser.username &&\n          (\n            <div className=\"edit\">\n              <form className=\"profileForm\">\n                {/* <div className = \"formInfo\">\n                <label for=\"username\">Username: </label>\n                    <input\n                    placeholder={ \"Username: \" + user.username }\n                    className=\"profileInput\"\n                    type=\"text\"\n                    ref={username || user.username}\n                    />\n                </div> */}\n                <div className=\"formInfo\">\n                  <label for=\"description\">Description: </label>\n                  <input\n                    placeholder={(user.desc || \"\")}\n                    type=\"text\"\n                    className=\"profileInput\"\n                    ref={desc || user.desc}\n                    autoComplete=\"text\"\n                  />\n                </div>\n                <div className=\"formInfo\">\n                  <label for=\"City\">City: </label>\n                  <input\n                    placeholder={(user.city || \"\")}\n                    type=\"text\"\n                    className=\"profileInput\"\n                    ref={city || currentUser.city}\n                    autoComplete=\"text\"\n                  />\n                </div>\n                <div className=\"formInfo\">\n                  <label for=\"From\">From: </label>\n                  <input\n                    placeholder={(user.from || \"\")}\n                    type=\"text\"\n                    className=\"profileInput\"\n                    ref={from || user.from}\n                    autoComplete=\"text\"\n                  />\n                </div>\n                <div className=\"formInfo\">\n                  <label for=\"relationship\">Relationship: </label>\n                  <input\n                    placeholder={\"input 1/2 \"}\n                    type=\"text\"\n                    className=\"profileInput\"\n                    ref={relationship || user.relationship}\n                    autoComplete=\"text\"\n                  />\n                </div>\n                <div className=\"formInfo\">\n                  <label for=\"oldPassword\">old password: </label>\n                  <input\n                    placeholder={\"****** \"}\n                    type=\"password\"\n                    className=\"profileInput\"\n                    ref={oldPassword}\n                    autoComplete=\"text\"\n                  />\n                </div>\n                <div className=\"formInfo\">\n                  <label for=\"password\"> new password: </label>\n                  <input\n                    placeholder={\"****** \"}\n                    type=\"password\"\n                    className=\"profileInput\"\n                    ref={password}\n                    autoComplete=\"text\"\n                  />\n                </div>\n              </form>\n\n              <button className=\"editButton\" type=\"submit\" onClick={submitHandler}>\n                <EditIcon fontSize=\"small\" />\n              </button>\n            </div>)}\n\n\n\n\n        <h4 className=\"rightbarTitle\">User information</h4>\n        <div className=\"rightbarInfo\">\n          <div className=\"rightbarInfoItem\">\n            <span className=\"rightbarInfoKey\">City:</span>\n            <span className=\"rightbarInfoValue\">{user.city}</span>\n          </div>\n          <div className=\"rightbarInfoItem\">\n            <span className=\"rightbarInfoKey\">From:</span>\n            <span className=\"rightbarInfoValue\">{user.from}</span>\n          </div>\n          <div className=\"rightbarInfoItem\">\n            <span className=\"rightbarInfoKey\">Relationship:</span>\n            <span className=\"rightbarInfoValue\">\n              {user.relationship === 1\n                ? \"Single\"\n                : user.relationship === 2\n                  ? \"Married\"\n                  : \"-\"}\n            </span>\n          </div>\n        </div>\n        <h4 className=\"rightbarTitle\">User friends</h4>\n        <div className=\"rightbarFollowings\">\n          {friends.map((friend) => (\n            <Link\n              to={\"/profile/\" + friend.username}\n              style={{ textDecoration: \"none\" }}\n            >\n              <div className=\"rightbarFollowing\">\n                <img\n                  src={\n                    friend.profilePicture\n                      ? PF + friend.profilePicture\n                      : PF + \"person/noAvatar.png\"\n                  }\n                  alt=\"\"\n                  className=\"rightbarFollowingImg\"\n                />\n                <span className=\"rightbarFollowingName\">{friend.username}</span>\n              </div>\n\n            </Link>\n          ))}\n        </div>\n      </>\n    );\n  };\n  return (\n    <div className=\"rightbar\">\n      <div className=\"rightbarWrapper\">\n        {user ? <ProfileRightbar /> : <HomeRightbar />}\n      </div>\n    </div>\n  );\n}\n","import Topbar from \"../../components/topbar/Topbar\";\nimport Sidebar from \"../../components/sidebar/Sidebar\";\nimport Feed from \"../../components/feed/Feed\";\nimport Rightbar from \"../../components/rightbar/Rightbar\";\nimport \"./home.css\"\nimport { useState } from \"react\";\n\nexport default function Home({socket}) {\n  const [searchTag, setSearchTag] = useState(null);\n  const [homePage, setHomePage] = useState(true);\n  const [timeLine, setTimeLine] = useState(false);\n\n  return (\n    <>\n      <Topbar setSearchTag={setSearchTag} setHomePage = {setHomePage} setTimeLine = {setTimeLine} socket={socket} />\n      <div className=\"homeContainer\">\n        <Sidebar />\n        <Feed searchTag={searchTag} homePage ={homePage} timeLine ={timeLine} socket={socket}/>\n        <Rightbar />\n      </div>\n    </>\n  );\n}\n","import axios from \"axios\";\n\nexport const loginCall = async (userCredential, dispatch) => {\n  dispatch({ type: \"LOGIN_START\" });\n  try {\n    const res = await axios.post(\"/auth/login\", userCredential);\n    dispatch({ type: \"LOGIN_SUCCESS\", payload: res.data });\n  } catch (err) {\n    dispatch({ type: \"LOGIN_FAILURE\", payload: err });\n  }\n};\n\n","import axios from \"axios\";\nimport { useContext, useRef, useEffect } from \"react\";\nimport \"./login.css\";\nimport { loginCall } from \"../../apiCalls\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { CircularProgress, Link, Grid } from \"@material-ui/core\";\nimport { Link as RouterLink } from \"react-router-dom\";\n\nexport default function Login() {\n  const form = useRef();\n  const email = useRef();\n  const password = useRef();\n  const { isFetching, dispatch, error } = useContext(AuthContext);\n\n\n\n  const emailConstraint = async () => {\n    const body = { email: email.current.value }\n    try {\n      console.log('check email')\n      const ifExistedEmail = await axios.post(`/auth/ifExistedEmail`, body);\n      const ret = ifExistedEmail.data\n      if (!ret) {\n        console.log('This email is not existed!')\n        email.current.setCustomValidity(\"This email is not existed!\")\n      } else {\n        console.log('This email is existed!')\n        email.current.setCustomValidity(\"\")\n      }\n      return ret;\n    } catch (err) {\n      console.log('wrong email')\n      console.log(err)\n      return false\n    }\n  }\n\n  const passwordConstraint = async () => {\n    try {\n      const body = { email: email.current.value, password: password.current.value }\n      await axios.post(`/auth/login`, body);\n      password.current.setCustomValidity(\"\")\n      console.log('password is right!')\n      return true;\n    } catch (err) {\n      console.log('password is wrong!', err)\n      password.current.setCustomValidity(\"This password is not correct!\")\n      return false\n    }\n\n  }\n  const handleClick = async () => {\n    form.current.reportValidity();\n    const constraint = await emailConstraint() && await passwordConstraint() && form.current.checkValidity();\n    console.log(constraint)\n    if (!constraint) {\n      return;\n    }\n    try {\n      loginCall(\n        { email: email.current.value, password: password.current.value },\n        dispatch\n      )\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <div className=\"login\">\n      <div className=\"loginWrapper\">\n        <div className=\"loginLeft\">\n          <h3 className=\"loginLogo\">Trojan Family</h3>\n          <span className=\"loginDesc\">\n            Connect with current students and alumni on Trojan Family.\n          </span>\n        </div>\n        <div className=\"loginRight\">\n          <form className=\"loginBox\" onSubmit={(e) => {\n            e.preventDefault();\n          }}\n            ref={form}>\n            <input\n              placeholder=\"Email\"\n              type=\"email\"\n              required\n              className=\"loginInput\"\n              ref={email}\n            />\n            <input\n              placeholder=\"Password\"\n              type=\"password\"\n              required\n              minLength=\"6\"\n              className=\"loginInput\"\n              ref={password}\n            />\n            <button className=\"loginButton\" disabled={isFetching}\n              onClick={() => {\n                console.log('onclick')\n                handleClick()\n              }}>\n              {isFetching ? (\n                <CircularProgress color=\"white\" size=\"20px\" />\n              ) : (\n                \"Log In\"\n              )}\n            </button>\n            <Grid container>\n              <Grid item xs>\n                <Link to=\"/register\" component={RouterLink}>\n                  Forget password?\n                </Link>\n              </Grid>\n              <Grid item>\n                <Link to=\"/register\" component={RouterLink}>\n                  Create a New Account\n                </Link>\n              </Grid>\n            </Grid>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import \"./profile.css\";\nimport Topbar from \"../../components/topbar/Topbar\";\nimport Sidebar from \"../../components/sidebar/Sidebar\";\nimport Feed from \"../../components/feed/Feed\";\nimport Rightbar from \"../../components/rightbar/Rightbar\";\nimport { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { useParams } from \"react-router\";\nimport { useContext } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\n\nexport default function Profile({socket}) {\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const [profileUser, setProfileUser] = useState({});\n  const { user: currentUser, dispatch } = useContext(AuthContext);\n  // const [profilePicName, setProfilePicName] = useState(\"person/noAvatar.png\");\n  const [profilePicName, setProfilePicName] = useState(\"person/noAvatar.png\");\n  const [coverPicName, setCoverPicName] = useState(\"person/noCover.png\")\n  const username = useParams().username;\n  const [profile, setProfile] = useState(true);\n  const [searchTag, setSearchTag] = useState(null);\n  const [homePage, setHomePage] = useState(false);\n  const [timeLine, setTimeLine] = useState(false);\n  const [user, setUser] = useState(currentUser);\n\n  // console.log('user: ', currentUser)\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const res = await axios.get(`/users?username=${username}`);\n      setProfileUser(res.data);\n      setProfilePicName(res.data.profilePicture ? res.data.profilePicture : \"person/noAvatar.png\");\n      setCoverPicName(res.data.coverPicture ? res.data.coverPicture : \"person/noCover.png\");\n    };\n    fetchUser();\n  }, [username, user]);\n\n  const uploadFile = async (imgFile, imgType, fileName) => {\n    const data = new FormData();\n    data.append(\"name\", fileName);\n    data.append(\"file\", imgFile);\n    try {\n      await axios.post(\"/upload\", data);\n      let updateInfo = {\n        \"userId\": currentUser._id\n      };\n      updateInfo[imgType] = fileName;\n      console.log('updateInfo', updateInfo)\n      await axios.put(\"/users/\" + currentUser._id, updateInfo);\n      const type = imgType === \"coverPicture\" ? 'UPDTAECPVER' : 'UPDTAEAVATAR'\n      dispatch({ type: type, payload: fileName })\n      console.log(\"Upload Successfully\");\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  const isCurUser = () => {\n    // cannot have two users who share the same name\n    return currentUser.username === username;\n  }\n\n  return (\n    <>\n      <Topbar setSearchTag={setSearchTag} setHomePage={setHomePage} setTimeLine={setTimeLine} socket={socket}/>\n      <div className=\"profile\">\n        <Sidebar />\n        <div className=\"profileRight\">\n          <div className=\"profileRightTop\">\n            <div className=\"coverAvatar\">\n              <div className={`changeCover ${isCurUser() ? \"changable\" : \"\"}`}>\n                <img\n                  className={`profileCoverImg`}\n                  src={PF + coverPicName}\n                  alt=\"\"\n                />\n                {\n                  isCurUser() &&\n                  (<>\n                    <input\n                      style={{ display: \"none\" }}\n                      type=\"file\"\n                      id=\"cover\"\n                      accept=\".png,.jpeg,.jpg\"\n                      onChange={async (e) => {\n                        const file = e.target.files[0];\n                        const fileName = Date.now() + file.name\n                        await uploadFile(file, \"coverPicture\", fileName);\n                        setCoverPicName(file.name);\n\n                      }}\n                    />\n                    <label className=\"coverLabel\" htmlFor=\"cover\"></label>\n                  </>)\n                }\n              </div>\n\n              <div className={`changeAvatar ${isCurUser() ? \"changable\" : \"\"}`}>\n                <img\n                  className={`profileAvatarImg`}\n                  src={PF + profilePicName}\n                  alt=\"\"\n                />{\n                  isCurUser() &&\n                  (<>\n                    <input\n                      style={{ display: \"none\" }}\n                      type=\"file\"\n                      id=\"avatar\"\n                      accept=\".png,.jpeg,.jpg\"\n                      onChange={async (e) => {\n                        const file = e.target.files[0];\n                        const fileName = Date.now() + file.name\n                        await uploadFile(file, \"profilePicture\", fileName);\n                        setProfilePicName(fileName);\n                      }}\n                    />\n                    <label className=\"avatarLabel\" htmlFor=\"avatar\"></label>\n                  </>)\n                }\n\n              </div>\n            </div>\n            <div className=\"profileInfo\">\n              <h4 className=\"profileInfoName\">{profileUser.username}</h4>\n              <span className=\"profileInfoDesc\">{profileUser.desc}</span>\n            </div>\n          </div>\n          <div className=\"profileRightBottom\">\n            <Feed searchTag={searchTag} homePage={homePage} timeLine={timeLine} username={username} profile={profile} socket={socket}/>\n            {/* <Feed username={username} profile={profile} /> */}\n            <Rightbar user={profileUser} setUser={setUser} socket={socket}/>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n","import axios from \"axios\";\nimport { useContext, useRef, useState } from \"react\";\nimport \"./register.css\";\n// import { useHistory } from \"react-router\";\nimport { Link, Grid } from \"@material-ui/core\";\nimport { loginCall } from \"../../apiCalls\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { Link as RouterLink } from \"react-router-dom\";\n\n\nexport default function Register() {\n  const form = useRef();\n  const username = useRef();\n  const email = useRef();\n  const password = useRef();\n  const passwordAgain = useRef();\n  // const history = useHistory();\n  const { dispatch } = useContext(AuthContext);\n\n  const passwordAgainConstraint = () => {\n    const ret = passwordAgain.current.value === password.current.value\n    if (!ret) {\n      console.log(\"Passwords don't match!\")\n      passwordAgain.current.setCustomValidity(\"Passwords don't match!\")\n    } else {\n      passwordAgain.current.setCustomValidity(\"\")\n    }\n    // form.current.reportValidity();\n    return ret\n  };\n\n  const usernameConstraint = async () => {\n    const body = { username: username.current.value }\n    const ifExistedUsername = await axios.post(`/auth/ifExistedUsername`, body);\n    const ret = ifExistedUsername.data\n    console.log('ret', ret)\n    if (ret) {\n      console.log(\"Exsisting username!\")\n      username.current.setCustomValidity(\"Exsisting username!\")\n    } else {\n      username.current.setCustomValidity(\"\")\n    }\n    // form.current.reportValidity();\n    return !ret;\n  }\n\n  const emailConstraint = async () => {\n    const body = { email: email.current.value }\n    const ifExistedEmail = await axios.post(`/auth/ifExistedEmail`, body);\n    const ret = ifExistedEmail.data\n    if (ret) {\n      console.log(\"Exsisting email!\")\n      email.current.setCustomValidity(\"Exsisting email!\")\n    } else {\n      email.current.setCustomValidity(\"\")\n    }\n    // form.current.reportValidity();\n    return !ret;\n  }\n\n  const handleClick = async () => {\n    form.current.reportValidity();\n    const constraint = await usernameConstraint() && await emailConstraint() && passwordAgainConstraint() && form.current.checkValidity();\n\n    if (!constraint) {\n      return;\n    }\n    const user = {\n      username: username.current.value,\n      email: email.current.value,\n      password: password.current.value,\n    };\n    try {\n      await axios.post(\"/auth/register\", user);\n      loginCall(\n        { email: email.current.value, password: password.current.value },\n        dispatch\n      )\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <div className=\"login\">\n      <div className=\"loginWrapper\">\n        <div className=\"loginLeft\">\n          <h3 className=\"loginLogo\">Trojan Family</h3>\n          <span className=\"loginDesc\">\n            Connect with current students and alumni on Trojan Family.\n          </span>\n        </div>\n        <div className=\"loginRight\">\n          <form className=\"loginBox\" onSubmit={(e) => {\n            e.preventDefault();\n          }}\n            ref={form}\n          >\n            <input\n              placeholder=\"Username\"\n              required\n              ref={username}\n              className=\"loginInput\"\n            />\n            <input\n              placeholder=\"Email\"\n              required\n              ref={email}\n              className=\"loginInput\"\n              type=\"email\"\n            />\n            <input\n              placeholder=\"Password\"\n              required\n              ref={password}\n              className=\"loginInput\"\n              type=\"password\"\n              minLength=\"6\"\n            />\n            <input\n              placeholder=\"Password Again\"\n              required\n              ref={passwordAgain}\n              className=\"loginInput\"\n              type=\"password\"\n            />\n            <button className=\"loginButton\" onClick={() => {\n              console.log(\"Submit Form!\")\n              handleClick()\n            }}>\n              Sign Up&Log in\n            </button>\n\n            <Grid\n              container\n              spacing={0}\n              direction=\"column\"\n              alignItems=\"center\"\n              justifyContent=\"center\"\n            >\n              <Link to='/login' component={RouterLink}>\n                Log into Account\n              </Link>\n            </Grid>\n          </form>\n        </div>\n      </div>\n    </div >\n  );\n}\n","import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport \"./conversation.css\";\n\nexport default function Conversation({ conversation, currentUser }) {\n  //get friend info\n  const [user, setUser] = useState(null);\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n  useEffect(() => {\n    const friendId = conversation.members.find((m) => m !== currentUser._id);\n\n    const getUser = async () => {\n      try {\n        const res = await axios(\"/users?userId=\" + friendId);\n        setUser(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    getUser();\n  }, [currentUser, conversation]);\n\n  return (\n    <div className=\"conversation\">\n      <img\n        className=\"conversationImg\"\n        src={\n          user?.profilePicture\n            ? PF + user.profilePicture\n            : PF + \"person/noAvatar.png\"\n        }\n        alt=\"\"\n      />\n      <span className=\"conversationName\">{user?.username}</span>\n    </div>\n  );\n}\n","import \"./message.css\";\nimport { format } from \"timeago.js\";\nimport { useContext } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport axios from \"axios\";\nimport { useEffect, useState } from \"react\";\n\nexport default function Message({ message, senderId }) {\n\n  const { user : currentUser } = useContext(AuthContext);\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    const getUser = async () => {\n      try {\n        const res = await axios(\"/users?userId=\" + senderId);\n        setUser(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    if(senderId !== currentUser._id) {\n      getUser();\n    }\n    \n  }, []);\n\n  return (\n    <div className={(senderId === currentUser._id )? \"message own\" : \"message\"}>\n      <div className=\"messageTop\">\n        <img\n          className=\"messageImg\"\n          src= { user === null  ? (currentUser.profilePicture ? PF + currentUser.profilePicture : PF + \"person/noAvatar.png\") :  \n                                  (user.profilePicture ? PF + user.profilePicture  : PF + \"person/noAvatar.png\")\n                } \n          alt=\"\"\n        />\n        <p className=\"messageText\">{message.text}</p>\n      </div>\n      <div className=\"messageBottom\">{format(message.createdAt)}</div>\n    </div>\n  );\n}\n","import axios from \"axios\";\nimport { useEffect, useState } from \"react\";\nimport \"./chatOnline.css\";\n\nexport default function ChatOnline({ onlineUsers, currentId, setCurrentChat }) {\n  const [friends, setFriends] = useState([]);\n  const [onlineFriends, setOnlineFriends] = useState([]);\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n  useEffect(() => {\n    const getFriends = async () => {\n      const res = await axios.get(\"/users/friends/\" + currentId);\n      setFriends(res.data);\n    };\n\n    getFriends();\n  }, [currentId]);\n\n  useEffect(() => {\n    setOnlineFriends(friends.filter((f) => onlineUsers.includes(f._id)));\n  }, [friends, onlineUsers]);\n\n  const handleClick = async (user) => {\n    try {\n      const res = await axios.get(\n        `/conversations/find/${currentId}/${user._id}`\n      );\n      setCurrentChat(res.data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return (\n    <div className=\"chatOnline\">\n      {onlineFriends.map((o) => (\n        <div className=\"chatOnlineFriend\" onClick={() => handleClick(o)}>\n          <div className=\"chatOnlineImgContainer\">\n            <img\n              className=\"chatOnlineImg\"\n              src={\n                o?.profilePicture\n                  ? PF + o.profilePicture\n                  : PF + \"person/noAvatar.png\"\n              }\n              alt=\"\"\n            />\n            <div className=\"chatOnlineBadge\"></div>\n          </div>\n          <span className=\"chatOnlineName\">{o?.username}</span>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import \"./messenger.css\";\nimport Topbar from \"../../components/topbar/Topbar\";\nimport Conversation from \"../../components/conversations/Conversation\";\nimport Message from \"../../components/message/Message\";\nimport ChatOnline from \"../../components/chatOnline/ChatOnline\";\nimport { useContext, useEffect, useRef, useState } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport axios from \"axios\";\nimport { io } from \"socket.io-client\";\n\nexport default function Messenger({socket}) {\n  const [conversations, setConversations] = useState([]);\n  const [currentChat, setCurrentChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [arrivalMessage, setArrivalMessage] = useState(null);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  //const socket = useRef();\n  const { user } = useContext(AuthContext);\n  const scrollRef = useRef();\n\n  useEffect(() => {\n    //socket = io(\"ws://localh ost:8900\");\n    socket?.on(\"getMessage\", (data) => {\n      setArrivalMessage({\n        sender: data.senderId,\n        text: data.text,\n        createdAt: Date.now(),\n      });\n    });\n  }, [socket]);\n\n  useEffect(() => {\n    arrivalMessage &&\n      currentChat?.members.includes(arrivalMessage.sender) &&\n      setMessages((prev) => [...prev, arrivalMessage]);\n  }, [arrivalMessage, currentChat]);\n\n  useEffect(() => {\n    socket?.emit(\"addUser\", user._id);\n    socket?.on(\"getUsers\", (users) => {\n      setOnlineUsers(\n        user.followings.filter((f) => users.some((u) => u.userId === f))\n      );\n    });\n  }, [user]);\n\n  useEffect(() => {\n    const getConversations = async () => {\n      try {\n        const res = await axios.get(\"/conversations/\" + user._id);\n        setConversations(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    getConversations();\n  }, [user._id]);\n\n  useEffect(() => {\n    const getMessages = async () => {\n      try {\n        const res = await axios.get(\"/messages/\" + currentChat?._id);\n        setMessages(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    getMessages();\n  }, [currentChat]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const message = {\n      sender: user._id,\n      text: newMessage,\n      conversationId: currentChat._id,\n    };\n\n    const receiverId = currentChat.members.find(\n      (member) => member !== user._id\n    );\n\n    socket.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverId,\n      text: newMessage,\n    });\n\n    socket.emit(\"sendMessageNotification\", {\n      // senderId: user._id,\n      senderName: user.username,\n      receiverId: receiverId\n    });\n\n    try {\n      const res = await axios.post(\"/messages\", message);\n      setMessages([...messages, res.data]);\n      setNewMessage(\"\");\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    scrollRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  return (\n    <>\n      <Topbar />\n      <div className=\"messenger\">\n        <div className=\"chatMenu\">\n          <div className=\"chatMenuWrapper\">\n            <input placeholder=\"Search for friends\" className=\"chatMenuInput\" />\n            {conversations.map((c) => (\n              <div onClick={() => setCurrentChat(c)}>\n                <Conversation conversation={c} currentUser={user} />\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className=\"chatBox\">\n          <div className=\"chatBoxWrapper\">\n            {currentChat ? (\n              <>\n                <div className=\"chatBoxTop\">\n                  {messages.map((m) => (\n                    <div ref={scrollRef}>\n                      <Message message={m} senderId={m.sender} />\n                    </div>\n                  ))}\n                </div>\n                <div className=\"chatBoxBottom\">\n                  <textarea\n                    className=\"chatMessageInput\"\n                    placeholder=\"write something...\"\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    value={newMessage}\n                  ></textarea>\n                  <button className=\"chatSubmitButton\" onClick={handleSubmit}>\n                    Send\n                  </button>\n                </div>\n              </>\n            ) : (\n              <span className=\"noConversationText\">\n                Open a conversation to start a chat.\n              </span>\n            )}\n          </div>\n        </div>\n        <div className=\"chatOnline\">\n          <div className=\"chatOnlineWrapper\">\n            <ChatOnline\n              onlineUsers={onlineUsers}\n              currentId={user._id}\n              setCurrentChat={setCurrentChat}\n            />\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n","import Home from './pages/home/Home'\nimport Login from './pages/login/Login'\nimport Profile from './pages/profile/Profile'\nimport Register from './pages/register/Register'\n\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\nimport { useContext } from 'react'\nimport { AuthContext } from './context/AuthContext'\nimport Messenger from './pages/messenger/Messenger'\nimport { io } from \"socket.io-client\";\nimport { useState, useEffect } from \"react\";\n\nfunction App() {\n  const { user } = useContext(AuthContext);\n  const [socket, setSocket] = useState(null);\n\n  useEffect(() => {\n    setSocket(io(\"http://chat-env-v1.eba-pdumi2zv.us-west-2.elasticbeanstalk.com\"));\n  }, []);\n\n  useEffect(() => {\n    socket?.emit(\"addUser\", user?._id);\n    socket?.on(\"getUsers\", (users) => {\n      // setOnlineUsers(\n      //   user.followings.filter((f) => users.some((u) => u.userId === f))\n      // );\n      console.log(users)\n    });\n  }, [socket, user]);\n\n  return (\n    <Router>\n      <Switch>\n        <Route exact path=\"/\">\n          {user ? <Home socket={socket}/> : <Login />}</Route>\n        <Route path=\"/login\">\n          {user ? <Redirect to=\"/\" /> : <Login />}</Route>\n        <Route path=\"/register\">\n          {user ? <Redirect to=\"/\" /> : <Register />}</Route>\n        <Route path=\"/messenger\">\n          {!user ? <Redirect to=\"/\" /> : <Messenger socket={socket}/>}</Route>\n        <Route path=\"/profile/:username\">\n          {user ? <Profile socket={socket}/> : <Redirect to=\"/\" />} </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { AuthContextProvider } from \"./context/AuthContext\";\nimport axios from 'axios'\n\naxios.defaults.baseURL = \"http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/api\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <AuthContextProvider>\n      <App />\n    </AuthContextProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}