(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{156:function(e,t,s){},183:function(e,t,s){},184:function(e,t,s){},185:function(e,t,s){},190:function(e,t,s){},191:function(e,t,s){},192:function(e,t,s){},193:function(e,t,s){},195:function(e,t,s){},196:function(e,t,s){},197:function(e,t,s){},198:function(e,t,s){},199:function(e,t,s){},200:function(e,t,s){},201:function(e,t,s){},202:function(e,t,s){},207:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),c=s(50),r=s.n(c),i=s(4),o=s(17),l=s(6),u=s.n(l),j=s(13),d=(s(156),s(258)),p=s(260),b=s(261),m=s(262),f=s(22),O=s(20),h=function(e,t){switch(t.type){case"LOGIN_START":return{user:null,isFetching:!0,error:!1};case"LOGIN_SUCCESS":return{user:t.payload,isFetching:!1,error:!1};case"LOGIN_FAILURE":return{user:null,isFetching:!1,error:!0};case"LOG_OUT":return{user:null,isFetching:!1,error:!1};case"FOLLOW":return Object(O.a)(Object(O.a)({},e),{},{user:Object(O.a)(Object(O.a)({},e.user),{},{followings:[].concat(Object(o.a)(e.user.followings),[t.payload])})});case"UNFOLLOW":return Object(O.a)(Object(O.a)({},e),{},{user:Object(O.a)(Object(O.a)({},e.user),{},{followings:e.user.followings.filter((function(e){return e!==t.payload}))})});case"UPDTAECPVER":return Object(O.a)(Object(O.a)({},e),{},{user:Object(O.a)(Object(O.a)({},e.user),{},{coverPicture:t.payload})});case"UPDTAEAVATAR":return Object(O.a)(Object(O.a)({},e),{},{user:Object(O.a)(Object(O.a)({},e.user),{},{profilePicture:t.payload})});case"UPDATEUSER":return Object(O.a)(Object(O.a)({},e),{},{user:Object(O.a)(Object(O.a)({},e.user),{},{city:t.payload,from:t.payload,desc:t.payload,relationship:t.payload,password:t.password,oldPassword:t.oldPassword})});default:return e}},x=s(1),v={user:JSON.parse(localStorage.getItem("user"))||null,isFetching:!1,error:!1},g=Object(a.createContext)(v),N=function(e){var t=e.children,s=Object(a.useReducer)(h,v),n=Object(i.a)(s,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){localStorage.setItem("user",JSON.stringify(c.user))}),[c.user]),Object(x.jsx)(g.Provider,{value:{user:c.user,isFetching:c.isFetching,error:c.error,dispatch:r},children:t})},w=s(12),I=s.n(w);function k(e){var t=e.setSearchTag,s=e.setHomePage,n=e.setTimeLine,c=e.socket,r=Object(a.useContext)(g),l=r.user,O=r.dispatch,h="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",v=Object(a.useState)([]),N=Object(i.a)(v,2),w=N[0],k=N[1],y=Object(a.useState)([]),C=Object(i.a)(y,2),A=C[0],S=C[1],P=Object(a.useState)([]),T=Object(i.a)(P,2),L=T[0],F=T[1],E=Object(a.useState)(!1),R=Object(i.a)(E,2),U=R[0],_=R[1],D=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O({type:"LOG_OUT"}),e.prev=1,e.next=4,I.a.get("/");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){null===c||void 0===c||c.on("getPostNotification",(function(e){k((function(t){return[].concat(Object(o.a)(t),[e])}))})),null===c||void 0===c||c.on("getFollowNotification",(function(e){S((function(t){return[].concat(Object(o.a)(t),[e])}))})),null===c||void 0===c||c.on("getMessageNotification",(function(e){F((function(t){return[].concat(Object(o.a)(t),[e])}))}))}),[c]),console.log(w);return Object(x.jsxs)("div",{className:"topbarContainer",children:[Object(x.jsx)("div",{className:"topbarLeft",children:Object(x.jsx)(f.b,{to:"/",style:{textDecoration:"none"},children:Object(x.jsx)("span",{className:"logo",children:"Trojan Familly"})})}),Object(x.jsx)("div",{className:"topbarCenter",children:Object(x.jsxs)("div",{className:"searchbar",children:[Object(x.jsx)(d.a,{className:"searchIcon"}),Object(x.jsx)("input",{placeholder:"Try searching for people, topics, or keywords",className:"searchInput",onChange:function(e){t(e.target.value)}})]})}),Object(x.jsxs)("div",{className:"topbarRight",children:[Object(x.jsxs)("div",{className:"topbarLinks",children:[Object(x.jsx)("span",{className:"topbarLink",onClick:function(){s(!0),n(!1)},children:"Homepage"}),Object(x.jsx)("span",{className:"topbarLink",onClick:function(){n(!0),s(!1)},children:"Timeline"}),Object(x.jsx)("span",{className:"topbarLink",onClick:D,children:"Log Out"})]}),Object(x.jsxs)("div",{className:"topbarIcons",onClick:function(){return _(!U)},children:[Object(x.jsxs)("div",{className:"topbarIconItem",children:[Object(x.jsx)(p.a,{}),A.length>0&&Object(x.jsx)("span",{className:"topbarIconBadge",children:A.length})]}),Object(x.jsxs)("div",{className:"topbarIconItem",children:[Object(x.jsx)(b.a,{}),L.length>0&&Object(x.jsx)(f.b,{to:"/messenger",style:{textDecoration:"none"},children:Object(x.jsx)("span",{className:"topbarIconBadge",children:L.length})})]}),Object(x.jsxs)("div",{className:"topbarIconItem",children:[Object(x.jsx)(m.a,{}),w.length>0&&Object(x.jsx)("span",{className:"topbarIconBadge",children:w.length})]})]}),U&&Object(x.jsxs)("div",{className:"notifications",children:[w.map((function(e){return function(e){var t,s=e.senderName;return t="like"===e.type?"liked":"commented",Object(x.jsx)("span",{className:"Notification",children:"".concat(s," ").concat(t," your post.")})}(e)})),A.map((function(e){return function(e){var t=e.senderName;return Object(x.jsx)("span",{className:"Notification",children:"".concat(t," followed you.")})}(e)})),L.map((function(e){return function(e){var t=e.senderName;return Object(x.jsx)("span",{className:"Notification",children:"".concat(t," sent you a new message.")})}(e)})),Object(x.jsx)("button",{className:"nButton",onClick:function(){k([]),S([]),F([]),_(!1)},children:"Mark as read"})]}),Object(x.jsx)(f.b,{to:"/profile/".concat(l.username),children:Object(x.jsx)("img",{src:l.profilePicture?h+l.profilePicture:h+"person/noAvatar.png",alt:"",className:"topbarImg"})})]})]})}s(183);var y=s(263),C=s(264),A=s(265),S=s(266),P=s(267),T=s(268),L=s(269),F=s(270),E=[{id:1,profilePicture:"person/1.jpeg",username:"Safak Kocaoglu"},{id:2,profilePicture:"person/2.jpeg",username:"Janell Shrum"},{id:3,profilePicture:"person/3.jpeg",username:"Alex Durden"},{id:4,profilePicture:"person/4.jpeg",username:"Dora Hawks"},{id:5,profilePicture:"person/5.jpeg",username:"Thomas Holden"},{id:6,profilePicture:"person/6.jpeg",username:"Shirley Beauchamp"},{id:7,profilePicture:"person/7.jpeg",username:"Travis Bennett"},{id:8,profilePicture:"person/8.jpeg",username:"Kristen Thomas"},{id:9,profilePicture:"person/9.jpeg",username:"Gary Duty"},{id:10,profilePicture:"person/10.jpeg",username:"Safak Kocaoglu"}];s(184);function R(e){var t=e.user;return Object(x.jsxs)("li",{className:"sidebarFriend",children:[Object(x.jsx)("img",{className:"sidebarFriendImg",src:"http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/"+t.profilePicture,alt:""}),Object(x.jsx)("span",{className:"sidebarFriendName",children:t.username})]})}function U(){return Object(x.jsx)("div",{className:"sidebar",children:Object(x.jsxs)("div",{className:"sidebarWrapper",children:[Object(x.jsxs)("ul",{className:"sidebarList",children:[Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(y.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(b.a,{className:"sidebarIcon"}),Object(x.jsx)(f.b,{to:"/messenger",style:{textDecoration:"none"},children:Object(x.jsx)("span",{className:"sidebarListItemText",children:"Chats"})})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(C.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Videos"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(A.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Groups"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(S.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Bookmarks"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(P.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Questions"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(T.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Jobs"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(L.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Events"})]}),Object(x.jsxs)("li",{className:"sidebarListItem",children:[Object(x.jsx)(F.a,{className:"sidebarIcon"}),Object(x.jsx)("span",{className:"sidebarListItemText",children:"Courses"})]})]}),Object(x.jsx)("button",{className:"sidebarButton",children:"Show More"}),Object(x.jsx)("hr",{className:"sidebarHr"}),Object(x.jsx)("ul",{className:"sidebarFriendList",children:E.map((function(e){return Object(x.jsx)(R,{user:e},e.id)}))})]})})}var _=s(79),D=(s(185),s(289)),B=s(92),V=s.n(B),W=s(291),K=s(66),H=s(293),q=s(298),M=s(292),G=s(288),J=s(299),Q=s(300),z=s(297);function X(e){var t=e.postId,s=e.postUserId,n=e.setcommentNum,c=e.socket,r=Object(a.useRef)(),l=Object(a.useState)([]),d=Object(i.a)(l,2),p=d[0],b=d[1],m=Object(a.useState)(!0),O=Object(i.a)(m,2),h=O[0],v=O[1],N=Object(a.useContext)(g).user,w="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/";Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(t){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,I.a.get("/posts/".concat(t,"/comments"));case 4:s=e.sent,b(s.data.sort((function(e,t){return new Date(t.timestamps)-new Date(e.timestamps)}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:v(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}})()(t)}),[t]);var k=function(){var e=Object(j.a)(u.a.mark((function e(){var a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N){e.next=4;break}window.alert("You are not login!"),e.next=18;break;case 4:return e.prev=4,e.next=7,I.a.post("/posts/".concat(t,"/comments"),{userId:null!==(a=N._id)&&void 0!==a?a:null,desc:r.current.value});case 7:i=e.sent,r.current.value=null,b((function(e){return[i.data].concat(Object(o.a)(e))})),n((function(e){return e+1})),console.log(p),c.emit("sendPostNotification",{senderName:N.username,receiverId:s,type:"comment"}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.error("Fail to post!");case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(j.a)(u.a.mark((function e(s,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.delete("/posts/"+s,{data:{userId:a,postId:t}});case 3:b((function(e){return e.filter((function(e){return e.commentId!==s}))})),n((function(e){return e-1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,s){return e.apply(this,arguments)}}();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(M.a,{component:"form",sx:{display:"flex",flex:"row nowrap",padding:"8px 16px",gap:"5px"},children:[Object(x.jsx)(G.a,{fullWidth:!0,inputRef:r,multiline:!0,variant:"standard"}),Object(x.jsx)(D.a,{onClick:k,children:"Comment"})]}),h&&Object(x.jsx)(M.a,{sx:{display:"flex",flex:"row nowarp",justifyContent:"center"},children:Object(x.jsx)(J.a,{size:"1rem"})}),Object(x.jsx)(H.a,{sx:{width:"100%",bgcolor:"background.paper"},children:Object(x.jsx)(z.a,{children:p.map((function(e){return Object(x.jsxs)(Q.a,{children:[Object(x.jsx)(q.a,{variant:"middle",component:"li"}),Object(x.jsxs)("div",{className:"commentTop",children:[Object(x.jsxs)("div",{className:"commentTopLeft",children:[Object(x.jsx)(f.b,{to:"/profile/".concat(e.username),children:Object(x.jsx)("img",{className:"commentProfileImg",src:e.avatar?w+e.avatar:w+"person/noAvatar.png",alt:""})}),Object(x.jsx)("span",{className:"postUsername",children:e.username}),Object(x.jsx)("span",{className:"postDate",children:Object(K.a)(e.timestamps)})]}),Object(x.jsx)("div",{children:e.username===N.username&&Object(x.jsx)(D.a,{size:"small",color:"primary",onClick:function(t){return y(e.commentId,e.userId)},children:Object(x.jsx)(V.a,{fontSize:"small"})})})]}),Object(x.jsx)("div",{className:"commentCenter",children:Object(x.jsx)("span",{className:"postText",children:null===e||void 0===e?void 0:e.content})})]},e.commentId)}))})})]})}var Y=s(279);function Z(e){var t=e.post,s=e.setPosts,n=e.socket,c=Object(a.useState)(t.likes.length),r=Object(i.a)(c,2),o=r[0],l=r[1],d=Object(a.useState)(!1),p=Object(i.a)(d,2),b=p[0],m=p[1],O=Object(a.useState)(t.comments.length),h=Object(i.a)(O,2),v=h[0],N=h[1],w=Object(a.useState)({}),k=Object(i.a)(w,2),y=k[0],C=k[1],A="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",S=Object(a.useContext)(g).user;Object(a.useEffect)((function(){m(t.likes.includes(S._id))}),[S._id,t.likes]);var P=Object(a.useState)(!1),T=Object(i.a)(P,2),L=T[0],F=T[1];Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/users?userId=".concat(t.userId));case 2:s=e.sent,C(s.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[t.userId]);var E=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.delete("/posts/"+t._id,{data:{userId:S._id}});case 3:s((function(e){return e.filter((function(e){return e._id!==t._id}))})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),R=function(){try{I.a.put("/posts/"+t._id+"/like",{userId:S._id})}catch(e){}l(b?o-1:o+1),m(!b),b||n.emit("sendPostNotification",{senderName:S.username,receiverId:t.userId,type:"like"})};return Object(x.jsxs)("div",{className:"post",children:[Object(x.jsxs)("div",{className:"postWrapper",children:[Object(x.jsxs)("div",{className:"postTop",children:[Object(x.jsxs)("div",{className:"postTopLeft",children:[Object(x.jsx)(f.b,{to:"/profile/".concat(y.username),children:Object(x.jsx)("img",{className:"postProfileImg",src:y.profilePicture?A+y.profilePicture:A+"person/noAvatar.png",alt:""})}),Object(x.jsx)("span",{className:"postUsername",children:y.username}),Object(x.jsx)("span",{className:"postDate",children:Object(K.a)(t.createdAt)})]}),Object(x.jsx)("div",{className:"postTopRight",children:t.userId===S._id&&Object(x.jsxs)(D.a,{size:"small",color:"primary",onClick:E,children:[Object(x.jsx)(V.a,{fontSize:"small"})," \xa0  Delete"]})})]}),Object(x.jsxs)("div",{className:"postCenter",children:[Object(x.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),Object(x.jsx)("img",{className:"postImg",src:A+t.img,alt:""})]}),""!==t.tags[0]&&Object(x.jsxs)("div",{className:"postSub",children:[Object(x.jsx)(Y.a,{htmlColor:"#5C94CD",className:"tagIcon"}),Object(x.jsxs)("span",{className:"tagText",children:[" ",function(e){var t,s="",a=Object(_.a)(e);try{for(a.s();!(t=a.n()).done;){s+=t.value+", "}}catch(n){a.e(n)}finally{a.f()}return s.slice(0,s.length-2)}(null===t||void 0===t?void 0:t.tags)]})]}),Object(x.jsxs)("div",{className:"postBottom",children:[Object(x.jsxs)("div",{className:"postBottomLeft",children:[Object(x.jsx)("img",{className:"likeIcon",src:"".concat(A,"like.png"),onClick:R,alt:""}),Object(x.jsx)("img",{className:"likeIcon",src:"".concat(A,"heart.png"),onClick:R,alt:""}),Object(x.jsxs)("span",{className:"postLikeCounter",children:[o," people like it"]})]}),Object(x.jsx)("div",{className:"postBottomRight",onClick:function(){F(!L)},children:Object(x.jsxs)("span",{className:"postCommentText",children:[v," comment(s)",Object(x.jsx)("img",{className:"postCommentArrow "+(L?"downward":""),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAB7UlEQVRIie2QT0iTcRjHv7+971uH6lAwooIOttlqcxphFBEM3R/eFljBS4FFBBV0CYROnTrUPTxKXSI6GEFZMX21HKsRJrbed8NteuigRSGEDY3Z9nueTobUnKt53Of6fb6fLzxAgwb1opy9eCXb7Gudydqp/HqK2wPB4PbdTY8Vj9eXU1Tt4R5vy2w+baXXQ37wWDBKwAOSfEmZTFsfm1vbEqpw3Hf7/PP5tDVRj/xQZ/gkEfdBlrs+JEffKACQs1KzHv+BIQf4rsvrL05l7PH/kbcHwt1EfIdJ6qlkfAIAlOUwZ6e+un1tgw5Qn8uzX5uezCT/Sd6hX2XmW0KIyPvEy9+vVlYeTWWsuSbXvqdQ1V73Xu+W6WwmUYv8cOfxa2C6rkJ0vIubuZWZqFQ4YRi7iNWRclkOmk/6e6rL9RsMvkAKBcdNc+bPvOIAAEROn9vBKA1zmUaGBx71AOC/5KHobRCdEqyE3r56/qmSZ9UBAIgYxjb5E0OSyR4daLkM3KTl3pFQtJeJjmobEHkdi82t5qg6AAABw9js+CFfSNAXsTjf7XQ6+fP34j3ikpsKQh8bixWq9dccAIBw+PymJa3wjIm+MTNLyVsXRKnLNs3Ftbo1DQCAS9c37mStn5mgLC2cicfjxVq7DRrUxy9bgs+Fme8W0AAAAABJRU5ErkJggg=="})]})})]})]}),Object(x.jsx)(W.a,{in:L,className:"commentWrapper",children:Object(x.jsx)(X,{className:"comment",postId:t._id,postUserId:t.userId,setcommentNum:N,socket:n})})]})}s(190);var $=s(280),ee=s(281),te=s(282),se=s(283);function ae(e){var t=e.setPosts,s=Object(a.useContext)(g).user,n="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",c=Object(a.useRef)(),r=Object(a.useRef)(),l=Object(a.useState)(null),d=Object(i.a)(l,2),p=d[0],b=d[1],m=Object(a.useState)(!1),O=Object(i.a)(m,2),h=(O[0],O[1]);Object(a.useEffect)((function(){h(!0)}),[s]);var v=function(){var e=Object(j.a)(u.a.mark((function e(a){var n,i,l,j,d,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),n=[],n=c.current.value.split(","),i=n.map((function(e){return e.toLowerCase().trim()})),l={userId:s._id,desc:r.current.value,tags:i},!p){e.next=19;break}return j=new FormData,d=Date.now()+p.name,j.append("name",d),j.append("file",p),l.img=d,console.log(l),e.prev=12,e.next=15,I.a.post("/upload",j);case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(12);case 19:return e.prev=19,e.next=22,I.a.post("/posts",l);case 22:m=e.sent,console.log(m),t((function(e){return[m.data].concat(Object(o.a)(e))})),r.current.value=null,c.current.value=null,b(null),e.next=32;break;case 30:e.prev=30,e.t1=e.catch(19);case 32:case"end":return e.stop()}}),e,null,[[12,17],[19,30]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"share",children:Object(x.jsxs)("div",{className:"shareWrapper",children:[Object(x.jsxs)("div",{className:"shareTop",children:[Object(x.jsx)(f.b,{to:"/profile/".concat(s.username),children:Object(x.jsx)("img",{className:"shareProfileImg",src:s.profilePicture?n+s.profilePicture:n+"person/noAvatar.png",alt:""})}),Object(x.jsxs)("form",{className:"shareForm",children:[Object(x.jsx)("input",{placeholder:"Hi "+s.username+", what's happening?",className:"shareInput",ref:r}),Object(x.jsxs)("div",{className:"shareOption",children:[Object(x.jsx)(Y.a,{htmlColor:"#5C94CD",className:"shareIcon"}),Object(x.jsx)("input",{placeholder:"# tags (comma is a must): weather, mood, study, travel, cat, ...",type:"text",className:"tagInput",ref:c,autoComplete:"text"})]})]})]}),Object(x.jsx)("hr",{className:"shareHr"}),p&&Object(x.jsxs)("div",{className:"shareImgContainer",children:[Object(x.jsx)("img",{className:"shareImg",src:URL.createObjectURL(p),alt:""}),Object(x.jsx)($.a,{className:"shareCancelImg",onClick:function(){return b(null)}})]}),Object(x.jsxs)("form",{className:"shareBottom",onSubmit:v,children:[Object(x.jsxs)("div",{className:"shareOptions",children:[Object(x.jsxs)("label",{htmlFor:"file",className:"shareOption",children:[Object(x.jsx)(ee.a,{htmlColor:"tomato",className:"shareIcon"}),Object(x.jsx)("span",{className:"shareOptionText",children:"Photo or Video"}),Object(x.jsx)("input",{style:{display:"none"},type:"file",id:"file",accept:".png,.jpeg,.jpg",onChange:function(e){return b(e.target.files[0])}})]}),Object(x.jsxs)("div",{className:"shareOption",children:[Object(x.jsx)(te.a,{htmlColor:"green",className:"shareIcon"}),Object(x.jsx)("span",{className:"shareOptionText",children:"Location"})]}),Object(x.jsxs)("div",{className:"shareOption",children:[Object(x.jsx)(se.a,{htmlColor:"goldenrod",className:"shareIcon"}),Object(x.jsx)("span",{className:"shareOptionText",children:"Feelings"})]})]}),Object(x.jsx)("button",{className:"shareButton",type:"submit",children:"Share"})]})]})})}s(191);function ne(e){var t=e.username,s=e.searchTag,n=e.profile,c=e.timeLine,r=e.homePage,o=e.socket,l=Object(a.useState)([]),d=Object(i.a)(l,2),p=d[0],b=d[1],m=Object(a.useContext)(g).user;return Object(a.useEffect)((function(){!0===c&&function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/posts/timeline/"+m._id);case 2:t=e.sent,b(t.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[c]),Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(u.a.mark((function e(){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/posts/profile/"+t);case 2:s=e.sent,b(s.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.log("profile name: ".concat(t,", profile: ").concat(n)),t&&e()}),[t,n]),Object(a.useEffect)((function(){!0===r&&function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/posts/homepage/"+m._id);case 2:t=e.sent,b(t.data.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,m._id,r]),Object(a.useEffect)((function(){m&&function(){var e=Object(j.a)(u.a.mark((function e(){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,I.a.get("/posts/profile/"+t);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,I.a.get("/posts/homepage/"+m._id);case 8:e.t0=e.sent;case 9:a=e.t0,n=a.data,s&&(n=n.filter((function(e){return e.tags.includes(s)||e.desc.includes(s)}))),b(n.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[s]),Object(x.jsx)("div",{className:"feed",children:Object(x.jsxs)("div",{className:"feedWrapper",children:[(!t||t===m.username)&&!0!==n&&Object(x.jsx)(ae,{setPosts:b}),p.map((function(e){return Object(x.jsx)(Z,{post:e,setPosts:b,socket:o},e._id)}))]})})}s(192),s(193);function ce(e){var t=e.user;return Object(x.jsxs)("li",{className:"rightbarFriend",children:[Object(x.jsxs)("div",{className:"rightbarProfileImgContainer",children:[Object(x.jsx)("img",{className:"rightbarProfileImg",src:"http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/"+t.profilePicture,alt:""}),Object(x.jsx)("span",{className:"rightbarOnline"})]}),Object(x.jsx)("span",{className:"rightbarUsername",children:t.username})]})}var re=s(135),ie=s.n(re),oe=s(284),le=s(285);function ue(e){var t=e.user,s=e.setUser,n=e.socket,c="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",r=(Object(a.useRef)(),Object(a.useRef)()),o=Object(a.useRef)(),l=Object(a.useRef)(),d=Object(a.useRef)(),p=Object(a.useRef)(),b=Object(a.useRef)(),m=Object(a.useState)([]),h=Object(i.a)(m,2),v=h[0],N=h[1],w=Object(a.useContext)(g),k=w.user,y=w.dispatch,C=Object(a.useState)(k.followings.includes(null===t||void 0===t?void 0:t._id)),A=Object(i.a)(C,2),S=A[0],P=A[1];Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.get("/users/friends/"+t._id);case 3:s=e.sent,N(s.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()(),P(k.followings.includes(null===t||void 0===t?void 0:t._id))}),[t]);var T=function(){var e=Object(j.a)(u.a.mark((function e(){var a,n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={userId:t._id,desc:l.current.value||t.desc,from:o.current.value||t.from,city:r.current.value||t.city,relationship:d.current.value||t.relationship},b.current.value&&p.current.value&&(a.password=b.current.value,a.oldPassword=p.current.value),console.log("userEdit",a),n=Object(O.a)(Object(O.a)({},t),a),s(n),console.log(n),e.prev=6,e.next=9,I.a.put("/users/"+t._id,a);case 9:if(c=e.sent,console.log(c),y({type:"UPDATEUSER",payload:a}),s(k),console.log("Upload Successfully"),l.current.value=null,o.current.value=null,r.current.value=null,d.current.value=null,!a.password){e.next=21;break}return e.next=21,L();case 21:b.current.value=null,p.current.value=null,e.next=28;break;case 25:e.prev=25,e.t0=e.catch(6),console.error(e.t0);case 28:case"end":return e.stop()}}),e,null,[[6,25]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y({type:"LOG_OUT"}),e.prev=1,e.next=4,I.a.get("/");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!S){e.next=7;break}return e.next=4,I.a.put("/users/".concat(t._id,"/unfollow"),{userId:k._id});case 4:y({type:"UNFOLLOW",payload:t._id}),e.next=10;break;case 7:return e.next=9,I.a.put("/users/".concat(t._id,"/follow"),{userId:k._id});case 9:y({type:"FOLLOW",payload:t._id});case 10:P(!S),S||n.emit("sendFollowNotification",{senderName:k.username,receiverId:t._id}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),R=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("div",{className:"birthdayContainer",children:[Object(x.jsx)("img",{className:"birthdayImg",src:"assets/gift.png",alt:""}),Object(x.jsxs)("span",{className:"birthdayText",children:[Object(x.jsx)("b",{children:"Pola Foster"})," and ",Object(x.jsx)("b",{children:"3 other friends"})," have a birhday today."]})]}),Object(x.jsx)("img",{className:"rightbarAd",src:"assets/usc.png",alt:""}),Object(x.jsx)("h4",{className:"rightbarTitle",children:"Online Friends"}),Object(x.jsx)("ul",{className:"rightbarFriendList",children:E.map((function(e){return Object(x.jsx)(ce,{user:e},e.id)}))})]})},U=function(){return Object(x.jsxs)(x.Fragment,{children:[t.username!==k.username&&Object(x.jsxs)("button",{className:"rightbarFollowButton",onClick:F,children:[S?"Unfollow":"Follow",S?Object(x.jsx)(oe.a,{}):Object(x.jsx)(le.a,{})]}),t.username===k.username&&Object(x.jsxs)("div",{className:"edit",children:[Object(x.jsxs)("form",{className:"profileForm",children:[Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"description",children:"Description: "}),Object(x.jsx)("input",{placeholder:t.desc||"",type:"text",className:"profileInput",ref:l||t.desc,autoComplete:"text"})]}),Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"City",children:"City: "}),Object(x.jsx)("input",{placeholder:t.city||"",type:"text",className:"profileInput",ref:r||k.city,autoComplete:"text"})]}),Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"From",children:"From: "}),Object(x.jsx)("input",{placeholder:t.from||"",type:"text",className:"profileInput",ref:o||t.from,autoComplete:"text"})]}),Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"relationship",children:"Relationship: "}),Object(x.jsx)("input",{placeholder:"input 1/2 ",type:"text",className:"profileInput",ref:d||t.relationship,autoComplete:"text"})]}),Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"oldPassword",children:"old password: "}),Object(x.jsx)("input",{placeholder:"****** ",type:"password",className:"profileInput",ref:p,autoComplete:"text"})]}),Object(x.jsxs)("div",{className:"formInfo",children:[Object(x.jsx)("label",{for:"password",children:" new password: "}),Object(x.jsx)("input",{placeholder:"****** ",type:"password",className:"profileInput",ref:b,autoComplete:"text"})]})]}),Object(x.jsx)("button",{className:"editButton",type:"submit",onClick:T,children:Object(x.jsx)(ie.a,{fontSize:"small"})})]}),Object(x.jsx)("h4",{className:"rightbarTitle",children:"User information"}),Object(x.jsxs)("div",{className:"rightbarInfo",children:[Object(x.jsxs)("div",{className:"rightbarInfoItem",children:[Object(x.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(x.jsx)("span",{className:"rightbarInfoValue",children:t.city})]}),Object(x.jsxs)("div",{className:"rightbarInfoItem",children:[Object(x.jsx)("span",{className:"rightbarInfoKey",children:"From:"}),Object(x.jsx)("span",{className:"rightbarInfoValue",children:t.from})]}),Object(x.jsxs)("div",{className:"rightbarInfoItem",children:[Object(x.jsx)("span",{className:"rightbarInfoKey",children:"Relationship:"}),Object(x.jsx)("span",{className:"rightbarInfoValue",children:1===t.relationship?"Single":2===t.relationship?"Married":"-"})]})]}),Object(x.jsx)("h4",{className:"rightbarTitle",children:"User friends"}),Object(x.jsx)("div",{className:"rightbarFollowings",children:v.map((function(e){return Object(x.jsx)(f.b,{to:"/profile/"+e.username,style:{textDecoration:"none"},children:Object(x.jsxs)("div",{className:"rightbarFollowing",children:[Object(x.jsx)("img",{src:e.profilePicture?c+e.profilePicture:c+"person/noAvatar.png",alt:"",className:"rightbarFollowingImg"}),Object(x.jsx)("span",{className:"rightbarFollowingName",children:e.username})]})})}))})]})};return Object(x.jsx)("div",{className:"rightbar",children:Object(x.jsx)("div",{className:"rightbarWrapper",children:t?Object(x.jsx)(U,{}):Object(x.jsx)(R,{})})})}s(195);function je(e){var t=e.socket,s=Object(a.useState)(null),n=Object(i.a)(s,2),c=n[0],r=n[1],o=Object(a.useState)(!0),l=Object(i.a)(o,2),u=l[0],j=l[1],d=Object(a.useState)(!1),p=Object(i.a)(d,2),b=p[0],m=p[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(k,{setSearchTag:r,setHomePage:j,setTimeLine:m,socket:t}),Object(x.jsxs)("div",{className:"homeContainer",children:[Object(x.jsx)(U,{}),Object(x.jsx)(ne,{searchTag:c,homePage:u,timeLine:b,socket:t}),Object(x.jsx)(ue,{})]})]})}s(196);var de=function(){var e=Object(j.a)(u.a.mark((function e(t,s){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"LOGIN_START"}),e.prev=1,e.next=4,I.a.post("/auth/login",t);case 4:a=e.sent,s({type:"LOGIN_SUCCESS",payload:a.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),s({type:"LOGIN_FAILURE",payload:e.t0});case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,s){return e.apply(this,arguments)}}(),pe=s(286),be=s(287),me=s(294);function fe(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useRef)(),n=Object(a.useContext)(g),c=n.isFetching,r=n.dispatch,i=(n.error,function(){var e=Object(j.a)(u.a.mark((function e(){var s,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={email:t.current.value},e.prev=1,console.log("check email"),e.next=5,I.a.post("/auth/ifExistedEmail",s);case 5:return a=e.sent,(n=a.data)?(console.log("This email is existed!"),t.current.setCustomValidity("")):(console.log("This email is not existed!"),t.current.setCustomValidity("This email is not existed!")),e.abrupt("return",n);case 11:return e.prev=11,e.t0=e.catch(1),console.log("wrong email"),console.log(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}()),o=function(){var e=Object(j.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={email:t.current.value,password:s.current.value},e.next=4,I.a.post("/auth/login",a);case 4:return s.current.setCustomValidity(""),console.log("password is right!"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(0),console.log("password is wrong!",e.t0),s.current.setCustomValidity("This password is not correct!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),l=function(){var a=Object(j.a)(u.a.mark((function a(){var n;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.current.reportValidity(),a.next=3,i();case 3:if(a.t1=a.sent,!a.t1){a.next=8;break}return a.next=7,o();case 7:a.t1=a.sent;case 8:if(a.t0=a.t1,!a.t0){a.next=11;break}a.t0=e.current.checkValidity();case 11:if(n=a.t0,console.log(n),n){a.next=15;break}return a.abrupt("return");case 15:try{de({email:t.current.value,password:s.current.value},r)}catch(c){console.log(c)}case 16:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"login",children:Object(x.jsxs)("div",{className:"loginWrapper",children:[Object(x.jsxs)("div",{className:"loginLeft",children:[Object(x.jsx)("h3",{className:"loginLogo",children:"Trojan Family"}),Object(x.jsx)("span",{className:"loginDesc",children:"Connect with current students and alumni on Trojan Family."})]}),Object(x.jsx)("div",{className:"loginRight",children:Object(x.jsxs)("form",{className:"loginBox",onSubmit:function(e){e.preventDefault()},ref:e,children:[Object(x.jsx)("input",{placeholder:"Email",type:"email",required:!0,className:"loginInput",ref:t}),Object(x.jsx)("input",{placeholder:"Password",type:"password",required:!0,minLength:"6",className:"loginInput",ref:s}),Object(x.jsx)("button",{className:"loginButton",disabled:c,onClick:function(){console.log("onclick"),l()},children:c?Object(x.jsx)(pe.a,{color:"white",size:"20px"}):"Log In"}),Object(x.jsxs)(be.a,{container:!0,children:[Object(x.jsx)(be.a,{item:!0,xs:!0,children:Object(x.jsx)(me.a,{to:"/register",component:f.b,children:"Forget password?"})}),Object(x.jsx)(be.a,{item:!0,children:Object(x.jsx)(me.a,{to:"/register",component:f.b,children:"Create a New Account"})})]})]})})]})})}s(197);var Oe=s(21);function he(e){var t=e.socket,s="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",n=Object(a.useState)({}),c=Object(i.a)(n,2),r=c[0],o=c[1],l=Object(a.useContext)(g),d=l.user,p=l.dispatch,b=Object(a.useState)("person/noAvatar.png"),m=Object(i.a)(b,2),f=m[0],O=m[1],h=Object(a.useState)("person/noCover.png"),v=Object(i.a)(h,2),N=v[0],w=v[1],y=Object(Oe.g)().username,C=Object(a.useState)(!0),A=Object(i.a)(C,2),S=A[0],P=(A[1],Object(a.useState)(null)),T=Object(i.a)(P,2),L=T[0],F=T[1],E=Object(a.useState)(!1),R=Object(i.a)(E,2),_=R[0],D=R[1],B=Object(a.useState)(!1),V=Object(i.a)(B,2),W=V[0],K=V[1],H=Object(a.useState)(d),q=Object(i.a)(H,2),M=q[0],G=q[1];Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/users?username=".concat(y));case 2:t=e.sent,o(t.data),O(t.data.profilePicture?t.data.profilePicture:"person/noAvatar.png"),w(t.data.coverPicture?t.data.coverPicture:"person/noCover.png");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[y,M]);var J=function(){var e=Object(j.a)(u.a.mark((function e(t,s,a){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("name",a),n.append("file",t),e.prev=3,e.next=6,I.a.post("/upload",n);case 6:return(c={userId:d._id})[s]=a,console.log("updateInfo",c),e.next=11,I.a.put("/users/"+d._id,c);case 11:p({type:"coverPicture"===s?"UPDTAECPVER":"UPDTAEAVATAR",payload:a}),console.log("Upload Successfully"),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t,s,a){return e.apply(this,arguments)}}(),Q=function(){return d.username===y};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(k,{setSearchTag:F,setHomePage:D,setTimeLine:K,socket:t}),Object(x.jsxs)("div",{className:"profile",children:[Object(x.jsx)(U,{}),Object(x.jsxs)("div",{className:"profileRight",children:[Object(x.jsxs)("div",{className:"profileRightTop",children:[Object(x.jsxs)("div",{className:"coverAvatar",children:[Object(x.jsxs)("div",{className:"changeCover ".concat(Q()?"changable":""),children:[Object(x.jsx)("img",{className:"profileCoverImg",src:s+N,alt:""}),Q()&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{style:{display:"none"},type:"file",id:"cover",accept:".png,.jpeg,.jpg",onChange:function(){var e=Object(j.a)(u.a.mark((function e(t){var s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.target.files[0],a=Date.now()+s.name,e.next=4,J(s,"coverPicture",a);case 4:w(s.name);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object(x.jsx)("label",{className:"coverLabel",htmlFor:"cover"})]})]}),Object(x.jsxs)("div",{className:"changeAvatar ".concat(Q()?"changable":""),children:[Object(x.jsx)("img",{className:"profileAvatarImg",src:s+f,alt:""}),Q()&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{style:{display:"none"},type:"file",id:"avatar",accept:".png,.jpeg,.jpg",onChange:function(){var e=Object(j.a)(u.a.mark((function e(t){var s,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.target.files[0],a=Date.now()+s.name,e.next=4,J(s,"profilePicture",a);case 4:O(a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object(x.jsx)("label",{className:"avatarLabel",htmlFor:"avatar"})]})]})]}),Object(x.jsxs)("div",{className:"profileInfo",children:[Object(x.jsx)("h4",{className:"profileInfoName",children:r.username}),Object(x.jsx)("span",{className:"profileInfoDesc",children:r.desc})]})]}),Object(x.jsxs)("div",{className:"profileRightBottom",children:[Object(x.jsx)(ne,{searchTag:L,homePage:_,timeLine:W,username:y,profile:S,socket:t}),Object(x.jsx)(ue,{user:r,setUser:G,socket:t})]})]})]})]})}s(198);function xe(){var e=Object(a.useRef)(),t=Object(a.useRef)(),s=Object(a.useRef)(),n=Object(a.useRef)(),c=Object(a.useRef)(),r=Object(a.useContext)(g).dispatch,i=function(){var e=c.current.value===n.current.value;return e?c.current.setCustomValidity(""):(console.log("Passwords don't match!"),c.current.setCustomValidity("Passwords don't match!")),e},o=function(){var e=Object(j.a)(u.a.mark((function e(){var s,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={username:t.current.value},e.next=3,I.a.post("/auth/ifExistedUsername",s);case 3:return a=e.sent,n=a.data,console.log("ret",n),n?(console.log("Exsisting username!"),t.current.setCustomValidity("Exsisting username!")):t.current.setCustomValidity(""),e.abrupt("return",!n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(j.a)(u.a.mark((function e(){var t,a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={email:s.current.value},e.next=3,I.a.post("/auth/ifExistedEmail",t);case 3:return a=e.sent,(n=a.data)?(console.log("Exsisting email!"),s.current.setCustomValidity("Exsisting email!")):s.current.setCustomValidity(""),e.abrupt("return",!n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var a=Object(j.a)(u.a.mark((function a(){var c;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.current.reportValidity(),a.next=3,o();case 3:if(a.t2=a.sent,!a.t2){a.next=8;break}return a.next=7,l();case 7:a.t2=a.sent;case 8:if(a.t1=a.t2,!a.t1){a.next=11;break}a.t1=i();case 11:if(a.t0=a.t1,!a.t0){a.next=14;break}a.t0=e.current.checkValidity();case 14:if(a.t0){a.next=17;break}return a.abrupt("return");case 17:return c={username:t.current.value,email:s.current.value,password:n.current.value},a.prev=18,a.next=21,I.a.post("/auth/register",c);case 21:de({email:s.current.value,password:n.current.value},r),a.next=27;break;case 24:a.prev=24,a.t3=a.catch(18),console.log(a.t3);case 27:case"end":return a.stop()}}),a,null,[[18,24]])})));return function(){return a.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"login",children:Object(x.jsxs)("div",{className:"loginWrapper",children:[Object(x.jsxs)("div",{className:"loginLeft",children:[Object(x.jsx)("h3",{className:"loginLogo",children:"Trojan Family"}),Object(x.jsx)("span",{className:"loginDesc",children:"Connect with current students and alumni on Trojan Family."})]}),Object(x.jsx)("div",{className:"loginRight",children:Object(x.jsxs)("form",{className:"loginBox",onSubmit:function(e){e.preventDefault()},ref:e,children:[Object(x.jsx)("input",{placeholder:"Username",required:!0,ref:t,className:"loginInput"}),Object(x.jsx)("input",{placeholder:"Email",required:!0,ref:s,className:"loginInput",type:"email"}),Object(x.jsx)("input",{placeholder:"Password",required:!0,ref:n,className:"loginInput",type:"password",minLength:"6"}),Object(x.jsx)("input",{placeholder:"Password Again",required:!0,ref:c,className:"loginInput",type:"password"}),Object(x.jsx)("button",{className:"loginButton",onClick:function(){console.log("Submit Form!"),d()},children:"Sign Up&Log in"}),Object(x.jsx)(be.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",children:Object(x.jsx)(me.a,{to:"/login",component:f.b,children:"Log into Account"})})]})})]})})}s(199),s(200);function ve(e){var t=e.conversation,s=e.currentUser,n=Object(a.useState)(null),c=Object(i.a)(n,2),r=c[0],o=c[1],l="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/";return Object(a.useEffect)((function(){var e=t.members.find((function(e){return e!==s._id}));(function(){var t=Object(j.a)(u.a.mark((function t(){var s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I()("/users?userId="+e);case 3:s=t.sent,o(s.data),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}})()()}),[s,t]),Object(x.jsxs)("div",{className:"conversation",children:[Object(x.jsx)("img",{className:"conversationImg",src:(null===r||void 0===r?void 0:r.profilePicture)?l+r.profilePicture:l+"person/noAvatar.png",alt:""}),Object(x.jsx)("span",{className:"conversationName",children:null===r||void 0===r?void 0:r.username})]})}s(201);function ge(e){var t=e.message,s=e.senderId,n=Object(a.useContext)(g).user,c="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/",r=Object(a.useState)(null),o=Object(i.a)(r,2),l=o[0],d=o[1];return Object(a.useEffect)((function(){var e=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I()("/users?userId="+s);case 3:t=e.sent,d(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();s!==n._id&&e()}),[]),Object(x.jsxs)("div",{className:s===n._id?"message own":"message",children:[Object(x.jsxs)("div",{className:"messageTop",children:[Object(x.jsx)("img",{className:"messageImg",src:null===l?n.profilePicture?c+n.profilePicture:c+"person/noAvatar.png":l.profilePicture?c+l.profilePicture:c+"person/noAvatar.png",alt:""}),Object(x.jsx)("p",{className:"messageText",children:t.text})]}),Object(x.jsx)("div",{className:"messageBottom",children:Object(K.a)(t.createdAt)})]})}s(202);function Ne(e){var t=e.onlineUsers,s=e.currentId,n=e.setCurrentChat,c=Object(a.useState)([]),r=Object(i.a)(c,2),o=r[0],l=r[1],d=Object(a.useState)([]),p=Object(i.a)(d,2),b=p[0],m=p[1],f="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/images/";Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("/users/friends/"+s);case 2:t=e.sent,l(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s]),Object(a.useEffect)((function(){m(o.filter((function(e){return t.includes(e._id)})))}),[o,t]);var O=function(){var e=Object(j.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.get("/conversations/find/".concat(s,"/").concat(t._id));case 3:a=e.sent,n(a.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"chatOnline",children:b.map((function(e){return Object(x.jsxs)("div",{className:"chatOnlineFriend",onClick:function(){return O(e)},children:[Object(x.jsxs)("div",{className:"chatOnlineImgContainer",children:[Object(x.jsx)("img",{className:"chatOnlineImg",src:(null===e||void 0===e?void 0:e.profilePicture)?f+e.profilePicture:f+"person/noAvatar.png",alt:""}),Object(x.jsx)("div",{className:"chatOnlineBadge"})]}),Object(x.jsx)("span",{className:"chatOnlineName",children:null===e||void 0===e?void 0:e.username})]})}))})}var we=s(106);function Ie(e){var t=e.socket,s=Object(a.useState)([]),n=Object(i.a)(s,2),c=n[0],r=n[1],l=Object(a.useState)(null),d=Object(i.a)(l,2),p=d[0],b=d[1],m=Object(a.useState)([]),f=Object(i.a)(m,2),O=f[0],h=f[1],v=Object(a.useState)(""),N=Object(i.a)(v,2),w=N[0],y=N[1],C=Object(a.useState)(null),A=Object(i.a)(C,2),S=A[0],P=A[1],T=Object(a.useState)([]),L=Object(i.a)(T,2),F=L[0],E=L[1],R=Object(a.useContext)(g).user,U=Object(a.useRef)();Object(a.useEffect)((function(){null===t||void 0===t||t.on("getMessage",(function(e){P({sender:e.senderId,text:e.text,createdAt:Date.now()})}))}),[t]),Object(a.useEffect)((function(){S&&(null===p||void 0===p?void 0:p.members.includes(S.sender))&&h((function(e){return[].concat(Object(o.a)(e),[S])}))}),[S,p]),Object(a.useEffect)((function(){null===t||void 0===t||t.emit("addUser",R._id),null===t||void 0===t||t.on("getUsers",(function(e){E(R.followings.filter((function(t){return e.some((function(e){return e.userId===t}))})))}))}),[R]),Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.get("/conversations/"+R._id);case 3:t=e.sent,r(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[R._id]),Object(a.useEffect)((function(){(function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.a.get("/messages/"+(null===p||void 0===p?void 0:p._id));case 3:t=e.sent,h(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[p]);var _=function(){var e=Object(j.a)(u.a.mark((function e(s){var a,n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),a={sender:R._id,text:w,conversationId:p._id},n=p.members.find((function(e){return e!==R._id})),t.emit("sendMessage",{senderId:R._id,receiverId:n,text:w}),t.emit("sendMessageNotification",{senderName:R.username,receiverId:n}),e.prev=5,e.next=8,I.a.post("/messages",a);case 8:c=e.sent,h([].concat(Object(o.a)(O),[c.data])),y(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){var e;null===(e=U.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[O]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(k,{}),Object(x.jsxs)("div",{className:"messenger",children:[Object(x.jsx)("div",{className:"chatMenu",children:Object(x.jsxs)("div",{className:"chatMenuWrapper",children:[Object(x.jsx)("input",{placeholder:"Search for friends",className:"chatMenuInput"}),c.map((function(e){return Object(x.jsx)("div",{onClick:function(){return b(e)},children:Object(x.jsx)(ve,{conversation:e,currentUser:R})})}))]})}),Object(x.jsx)("div",{className:"chatBox",children:Object(x.jsx)("div",{className:"chatBoxWrapper",children:p?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"chatBoxTop",children:O.map((function(e){return Object(x.jsx)("div",{ref:U,children:Object(x.jsx)(ge,{message:e,senderId:e.sender})})}))}),Object(x.jsxs)("div",{className:"chatBoxBottom",children:[Object(x.jsx)("textarea",{className:"chatMessageInput",placeholder:"write something...",onChange:function(e){return y(e.target.value)},value:w}),Object(x.jsx)("button",{className:"chatSubmitButton",onClick:_,children:"Send"})]})]}):Object(x.jsx)("span",{className:"noConversationText",children:"Open a conversation to start a chat."})})}),Object(x.jsx)("div",{className:"chatOnline",children:Object(x.jsx)("div",{className:"chatOnlineWrapper",children:Object(x.jsx)(Ne,{onlineUsers:F,currentId:R._id,setCurrentChat:b})})})]})]})}var ke=function(){var e=Object(a.useContext)(g).user,t=Object(a.useState)(null),s=Object(i.a)(t,2),n=s[0],c=s[1];return Object(a.useEffect)((function(){c(Object(we.a)("http://chat-env-v1.eba-pdumi2zv.us-west-2.elasticbeanstalk.com"))}),[]),Object(a.useEffect)((function(){null===n||void 0===n||n.emit("addUser",null===e||void 0===e?void 0:e._id),null===n||void 0===n||n.on("getUsers",(function(e){console.log(e)}))}),[n,e]),Object(x.jsx)(f.a,{children:Object(x.jsxs)(Oe.d,{children:[Object(x.jsx)(Oe.b,{exact:!0,path:"/",children:e?Object(x.jsx)(je,{socket:n}):Object(x.jsx)(fe,{})}),Object(x.jsx)(Oe.b,{path:"/login",children:e?Object(x.jsx)(Oe.a,{to:"/"}):Object(x.jsx)(fe,{})}),Object(x.jsx)(Oe.b,{path:"/register",children:e?Object(x.jsx)(Oe.a,{to:"/"}):Object(x.jsx)(xe,{})}),Object(x.jsx)(Oe.b,{path:"/messenger",children:e?Object(x.jsx)(Ie,{socket:n}):Object(x.jsx)(Oe.a,{to:"/"})}),Object(x.jsxs)(Oe.b,{path:"/profile/:username",children:[e?Object(x.jsx)(he,{socket:n}):Object(x.jsx)(Oe.a,{to:"/"})," "]})]})})};I.a.defaults.baseURL="http://env-v1.eba-pce2husc.us-west-2.elasticbeanstalk.com/api",r.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(N,{children:Object(x.jsx)(ke,{})})}),document.getElementById("root"))}},[[207,1,2]]]);
//# sourceMappingURL=main.80232ef6.chunk.js.map